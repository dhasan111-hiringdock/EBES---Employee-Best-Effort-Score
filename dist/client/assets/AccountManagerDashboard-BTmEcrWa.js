import{c as he,r as i,g as es,u as Ls,a as ts,j as e,T as le,L as Ms,C as Ae,M as Fs,R as Bs,b as me,N as zs}from"./index-C7EJkjUr.js";import{o as de,s as ke,r as Us,p as B,q as ss,t as Ks,u as ze,v as as,w as nt,x as qs,y as rs,z as lt,E as Ws,G as Hs,H as Ys,I as Vs,J as Gs,K as H,M as ns,Z as Ue,O as Ke,P as Y,Q as V,S as ls,V as is,W as qe,_ as os,$ as Zs,a0 as Js,a1 as Xs,a2 as ie,a3 as Qs,a4 as ea,a5 as ds,a6 as cs,a7 as xs,a8 as ms,a9 as ta,aa as sa,ab as aa,ac as us,ad as Me,ae as ra,af as na,ag as _t,ah as la,ai as ia,aj as oa,ak as hs,al as da,am as St,an as ca,ao as kt,ap as xa,aq as ma,ar as ua,as as ha,at as Te,au as gs,av as ga,C as ps,a as Ce,b as bs,N as pa,T as ve,c as se,k as Fe,F as At,D as ba,aw as it,A as st,ax as Pt,d as Ct,f as Se,i as Ve,X as Ge,Y as $e,h as Ie,j as Le,g as fa,B as Rt,l as Ot,L as va,R as ja,ay as Et,n as ya}from"./CompanyPage-bcY5Um_O.js";import{f as L}from"./api-D8SveD0E.js";import{B as oe}from"./building-2-Cuz0WzKd.js";import{U as G}from"./users-C13lqfXm.js";import{B as We}from"./briefcase-DAyzHxKh.js";import{L as Na}from"./log-out-D2TEcKqa.js";import{X as je,P as He,T as ot,S as wa}from"./x-yUVYYHrF.js";import{D as _a,A as Sa,a as ka,C as at,S as fs,L as Dt,b as Aa,E as Pa}from"./ScoreTooltip-CZNaDlST.js";import{s as Ca,b as Ra,c as Oa,d as Ea,e as Da,f as Ta,P as $a,a as Ia}from"./PieChart-Uib3cxLe.js";import"./search-CUq3Q4fS.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],Ma=he("arrow-down-right",La);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Ba=he("arrow-up-right",Fa);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],Ua=he("chart-no-axes-column-increasing",za);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],qa=he("dollar-sign",Ka);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=[["path",{d:"M5 12h14",key:"1ays0h"}]],Tt=he("minus",Wa);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],Ya=he("percent",Ha);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],rt=he("refresh-cw",Va);var Ga=["points","className","baseLinePoints","connectNulls"],$t;function fe(){return fe=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},fe.apply(null,arguments)}function Za(t,s){if(t==null)return{};var a,r,l=Ja(t,s);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(r=0;r<d.length;r++)a=d[r],s.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}function Ja(t,s){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(s.indexOf(r)!==-1)continue;a[r]=t[r]}return a}function Xa(t,s){return s||(s=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(s)}}))}var It=t=>t&&t.x===+t.x&&t.y===+t.y,Qa=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=[[]];return s.forEach(r=>{It(r)?a[a.length-1].push(r):a[a.length-1].length>0&&a.push([])}),It(s[0])&&a[a.length-1].push(s[0]),a[a.length-1].length<=0&&(a=a.slice(0,-1)),a},Pe=(t,s)=>{var a=Qa(t);s&&(a=[a.reduce((l,d)=>[...l,...d],[])]);var r=a.map(l=>l.reduce((d,o,c)=>Us($t||($t=Xa(["","","",",",""])),d,c===0?"M":"L",o.x,o.y),"")).join("");return a.length===1?"".concat(r,"Z"):r},er=(t,s,a)=>{var r=Pe(t,a);return"".concat(r.slice(-1)==="Z"?r.slice(0,-1):r,"L").concat(Pe(Array.from(s).reverse(),a).slice(1))},vs=t=>{var{points:s,className:a,baseLinePoints:r,connectNulls:l}=t,d=Za(t,Ga);if(!s||!s.length)return null;var o=de("recharts-polygon",a);if(r&&r.length){var c=d.stroke&&d.stroke!=="none",m=er(s,r,l);return i.createElement("g",{className:o},i.createElement("path",fe({},ke(d),{fill:m.slice(-1)==="Z"?d.fill:"none",stroke:"none",d:m})),c?i.createElement("path",fe({},ke(d),{fill:"none",d:Pe(s,l)})):null,c?i.createElement("path",fe({},ke(d),{fill:"none",d:Pe(r,l)})):null)}var h=Pe(s,l);return i.createElement("path",fe({},ke(d),{fill:h.slice(-1)==="Z"?d.fill:"none",className:o,d:h}))},dt=(t,s,a)=>{switch(s){case"angleAxis":return lt(t,a);case"radiusAxis":return rs(t,a);default:throw new Error("Unexpected axis type: ".concat(s))}},ct=(t,s,a)=>{switch(s){case"angleAxis":return Hs(t,a);case"radiusAxis":return Ws(t,a);default:throw new Error("Unexpected axis type: ".concat(s))}},ye=B([dt,ss,Ca,ct],Ks),js=B([ze,Oa,Ys,nt],Vs),Ne=B([ze,dt,ss,ye,Ra,ct,as,js,nt],qs),tr=B([Ne],t=>{if(t){var s=new Map;return t.forEach(a=>{var r=(a.coordinate+360)%360;s.has(r)||s.set(r,a)}),Array.from(s.values())}});B([ze,dt,ye,ct,as,js,nt],Gs);var sr=(t,s)=>Ne(t,"angleAxis",s,!1),ar=B([sr],t=>{if(t)return t.map(s=>s.coordinate)}),rr=(t,s)=>Ne(t,"radiusAxis",s,!1),nr=B([rr],t=>{if(t)return t.map(s=>s.coordinate)}),lr=["gridType","radialLines","angleAxisId","radiusAxisId","cx","cy","innerRadius","outerRadius","polarAngles","polarRadius"];function ir(t,s){if(t==null)return{};var a,r,l=or(t,s);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(r=0;r<d.length;r++)a=d[r],s.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}function or(t,s){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(s.indexOf(r)!==-1)continue;a[r]=t[r]}return a}function W(){return W=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},W.apply(null,arguments)}function Lt(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,r)}return a}function Re(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Lt(Object(a),!0).forEach(function(r){dr(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Lt(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function dr(t,s,a){return(s=cr(s))in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function cr(t){var s=xr(t,"string");return typeof s=="symbol"?s:s+""}function xr(t,s){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var mr=(t,s,a,r)=>{var l="";return r.forEach((d,o)=>{var c=V(s,a,t,d);o?l+="L ".concat(c.x,",").concat(c.y):l+="M ".concat(c.x,",").concat(c.y)}),l+="Z",l},ur=t=>{var{cx:s,cy:a,innerRadius:r,outerRadius:l,polarAngles:d,radialLines:o}=t;if(!d||!d.length||!o)return null;var c=Re({stroke:"#ccc"},Y(t));return i.createElement("g",{className:"recharts-polar-grid-angle"},d.map(m=>{var h=V(s,a,r,m),f=V(s,a,l,m);return i.createElement("line",W({key:"line-".concat(m)},c,{x1:h.x,y1:h.y,x2:f.x,y2:f.y}))}))},Mt=t=>{var{cx:s,cy:a,radius:r}=t,l=Re({stroke:"#ccc",fill:"none"},Y(t));return i.createElement("circle",W({},l,{className:de("recharts-polar-grid-concentric-circle",t.className),cx:s,cy:a,r}))},Ft=t=>{var{radius:s}=t,a=Re({stroke:"#ccc",fill:"none"},Y(t));return i.createElement("path",W({},a,{className:de("recharts-polar-grid-concentric-polygon",t.className),d:mr(s,t.cx,t.cy,t.polarAngles)}))},hr=t=>{var{polarRadius:s,gridType:a}=t;if(!s||!s.length)return null;var r=Math.max(...s),l=t.fill&&t.fill!=="none";return i.createElement("g",{className:"recharts-polar-grid-concentric"},l&&a==="circle"&&i.createElement(Mt,W({},t,{radius:r})),l&&a!=="circle"&&i.createElement(Ft,W({},t,{radius:r})),s.map((d,o)=>{var c=o;return a==="circle"?i.createElement(Mt,W({key:c},t,{fill:"none",radius:d})):i.createElement(Ft,W({key:c},t,{fill:"none",radius:d}))}))},ys=t=>{var s,a,r,l,d,o,c,m,h,{gridType:f="polygon",radialLines:v=!0,angleAxisId:N=0,radiusAxisId:k=0,cx:g,cy:P,innerRadius:$,outerRadius:R,polarAngles:j,polarRadius:b}=t,E=ir(t,lr),x=H(Ke),p=H(we=>ar(we,N)),y=H(we=>nr(we,k)),D=Array.isArray(j)?j:p,Z=Array.isArray(b)?b:y;if(D==null||Z==null)return null;var ce=Re(Re({cx:(s=(a=x==null?void 0:x.cx)!==null&&a!==void 0?a:g)!==null&&s!==void 0?s:0,cy:(r=(l=x==null?void 0:x.cy)!==null&&l!==void 0?l:P)!==null&&r!==void 0?r:0,innerRadius:(d=(o=x==null?void 0:x.innerRadius)!==null&&o!==void 0?o:$)!==null&&d!==void 0?d:0,outerRadius:(c=(m=x==null?void 0:x.outerRadius)!==null&&m!==void 0?m:R)!==null&&c!==void 0?c:0,polarAngles:D,polarRadius:Z},E),{},{zIndex:(h=E.zIndex)!==null&&h!==void 0?h:ns.grid}),{outerRadius:De}=ce;return De<=0?null:i.createElement(Ue,{zIndex:ce.zIndex},i.createElement("g",{className:"recharts-polar-grid"},i.createElement(hr,W({gridType:f,radialLines:v},ce,{polarAngles:D,polarRadius:Z})),i.createElement(ur,W({gridType:f,radialLines:v},ce,{polarAngles:D,polarRadius:Z}))))};ys.displayName="PolarGrid";var Ze={},Je={},Bt;function gr(){return Bt||(Bt=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(a,r){if(a.length===0)return;let l=a[0],d=r(l);for(let o=1;o<a.length;o++){const c=a[o],m=r(c);m>d&&(d=m,l=c)}return l}t.maxBy=s})(Je)),Je}var zt;function pr(){return zt||(zt=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=gr(),a=is(),r=ls();function l(d,o){if(d!=null)return s.maxBy(Array.from(d),r.iteratee(o??a.identity))}t.maxBy=l})(Ze)),Ze}var Xe,Ut;function br(){return Ut||(Ut=1,Xe=pr().maxBy),Xe}var fr=br();const vr=es(fr);var Qe={},et={},Kt;function jr(){return Kt||(Kt=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function s(a,r){if(a.length===0)return;let l=a[0],d=r(l);for(let o=1;o<a.length;o++){const c=a[o],m=r(c);m<d&&(d=m,l=c)}return l}t.minBy=s})(et)),et}var qt;function yr(){return qt||(qt=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const s=jr(),a=is(),r=ls();function l(d,o){if(d!=null)return s.minBy(Array.from(d),r.iteratee(o??a.identity))}t.minBy=l})(Qe)),Qe}var tt,Wt;function Nr(){return Wt||(Wt=1,tt=yr().minBy),tt}var wr=Nr();const _r=es(wr);var Sr=["cx","cy","angle","axisLine"],kr=["angle","tickFormatter","stroke","tick"];function Oe(){return Oe=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},Oe.apply(null,arguments)}function Ht(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,r)}return a}function ae(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Ht(Object(a),!0).forEach(function(r){Ar(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Ht(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Ar(t,s,a){return(s=Pr(s))in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Pr(t){var s=Cr(t,"string");return typeof s=="symbol"?s:s+""}function Cr(t,s){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Ns(t,s){if(t==null)return{};var a,r,l=Rr(t,s);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(r=0;r<d.length;r++)a=d[r],s.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}function Rr(t,s){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(s.indexOf(r)!==-1)continue;a[r]=t[r]}return a}var Or="radiusAxis";function Er(t){var s=os();return i.useEffect(()=>(s(Zs(t)),()=>{s(Js(t))})),null}var Dr=(t,s,a,r)=>{var{coordinate:l}=t;return V(a,r,l,s)},Tr=t=>{var s;switch(t){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s},$r=(t,s,a,r)=>{var l=vr(r,o=>o.coordinate||0),d=_r(r,o=>o.coordinate||0);return{cx:s,cy:a,startAngle:t,endAngle:t,innerRadius:(d==null?void 0:d.coordinate)||0,outerRadius:(l==null?void 0:l.coordinate)||0,clockWise:!1}},Ir=(t,s)=>{var{cx:a,cy:r,angle:l,axisLine:d}=t,o=Ns(t,Sr),c=s.reduce((v,N)=>[Math.min(v[0],N.coordinate),Math.max(v[1],N.coordinate)],[1/0,-1/0]),m=V(a,r,c[0],l),h=V(a,r,c[1],l),f=ae(ae(ae({},Y(o)),{},{fill:"none"},Y(d)),{},{x1:m.x,y1:m.y,x2:h.x,y2:h.y});return i.createElement("line",Oe({className:"recharts-polar-radius-axis-line"},f))},Lr=(t,s,a)=>{var r;return i.isValidElement(t)?r=i.cloneElement(t,s):typeof t=="function"?r=t(s):r=i.createElement(ms,Oe({},s,{className:"recharts-polar-radius-axis-tick-value"}),a),r},Mr=(t,s)=>{var{angle:a,tickFormatter:r,stroke:l,tick:d}=t,o=Ns(t,kr),c=Tr(t.orientation),m=Y(o),h=ds(d),f=s.map((v,N)=>{var k=Dr(v,t.angle,t.cx,t.cy),g=ae(ae(ae(ae({textAnchor:c,transform:"rotate(".concat(90-a,", ").concat(k.x,", ").concat(k.y,")")},m),{},{stroke:"none",fill:l},h),{},{index:N},k),{},{payload:v});return i.createElement(ie,Oe({className:de("recharts-polar-radius-axis-tick",xs(d)),key:"tick-".concat(v.coordinate)},cs(t,v,N)),Lr(d,g,r?r(v.value,N):v.value))});return i.createElement(ie,{className:"recharts-polar-radius-axis-ticks"},f)},Fr=t=>{var{radiusAxisId:s}=t,a=H(Ke),r=H(m=>ye(m,"radiusAxis",s)),l=H(m=>Ne(m,"radiusAxis",s,!1));if(a==null||!l||!l.length||r==null)return null;var d=ae(ae({},t),{},{scale:r},a),{tick:o,axisLine:c}=d;return i.createElement(Ue,{zIndex:d.zIndex},i.createElement(ie,{className:de("recharts-polar-radius-axis",Or,d.className)},c&&Ir(d,l),o&&Mr(d,l),i.createElement(Qs,$r(d.angle,d.cx,d.cy,l),i.createElement(ea,{label:d.label}),d.children)))};function ws(t){var s=qe(t,Xs);return i.createElement(i.Fragment,null,i.createElement(Er,{domain:s.domain,id:s.radiusAxisId,scale:s.scale,type:s.type,dataKey:s.dataKey,unit:void 0,name:s.name,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDataOverflow:s.allowDataOverflow,reversed:s.reversed,includeHidden:s.includeHidden,allowDecimals:s.allowDecimals,ticks:s.ticks,tickCount:s.tickCount,tick:s.tick}),i.createElement(Fr,s))}ws.displayName="PolarRadiusAxis";var Br=["children"];function ue(){return ue=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},ue.apply(null,arguments)}function Yt(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,r)}return a}function X(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Yt(Object(a),!0).forEach(function(r){zr(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Yt(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function zr(t,s,a){return(s=Ur(s))in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Ur(t){var s=Kr(t,"string");return typeof s=="symbol"?s:s+""}function Kr(t,s){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function qr(t,s){if(t==null)return{};var a,r,l=Wr(t,s);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(r=0;r<d.length;r++)a=d[r],s.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}function Wr(t,s){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(s.indexOf(r)!==-1)continue;a[r]=t[r]}return a}var Vt=1e-5,Hr=Math.cos(Me(45)),Yr="angleAxis";function Vr(t){var s=os(),a=i.useMemo(()=>{var{children:d}=t,o=qr(t,Br);return o},[t]),r=H(d=>lt(d,a.id)),l=a===r;return i.useEffect(()=>(s(ta(a)),()=>{s(sa(a))}),[s,a]),l?t.children:null}var Gr=(t,s)=>{var{cx:a,cy:r,radius:l,orientation:d,tickSize:o}=s,c=o||8,m=V(a,r,l,t.coordinate),h=V(a,r,l+(d==="inner"?-1:1)*c,t.coordinate);return{x1:m.x,y1:m.y,x2:h.x,y2:h.y}},Zr=(t,s)=>{var a=Math.cos(Me(-t.coordinate));return a>Vt?s==="outer"?"start":"end":a<-Vt?s==="outer"?"end":"start":"middle"},Jr=t=>{var s=Math.cos(Me(-t.coordinate)),a=Math.sin(Me(-t.coordinate));return Math.abs(s)<=Hr?a>0?"start":"end":"middle"},Xr=t=>{var{cx:s,cy:a,radius:r,axisLineType:l,axisLine:d,ticks:o}=t;if(!d)return null;var c=X(X({},Y(t)),{},{fill:"none"},Y(d));if(l==="circle")return i.createElement(_a,ue({className:"recharts-polar-angle-axis-line"},c,{cx:s,cy:a,r}));var m=o.map(h=>V(s,a,r,h.coordinate));return i.createElement(vs,ue({className:"recharts-polar-angle-axis-line"},c,{points:m}))},Qr=t=>{var{tick:s,tickProps:a,value:r}=t;return s?i.isValidElement(s)?i.cloneElement(s,a):typeof s=="function"?s(a):i.createElement(ms,ue({},a,{className:"recharts-polar-angle-axis-tick-value"}),r):null},en=t=>{var{tick:s,tickLine:a,tickFormatter:r,stroke:l,ticks:d}=t,o=Y(t),c=ds(s),m=X(X({},o),{},{fill:"none"},Y(a)),h=d.map((f,v)=>{var N=Gr(f,t),k=Zr(f,t.orientation),g=Jr(f),P=X(X(X({},o),{},{textAnchor:k,verticalAnchor:g,stroke:"none",fill:l},c),{},{index:v,payload:f,x:N.x2,y:N.y2});return i.createElement(ie,ue({className:de("recharts-polar-angle-axis-tick",xs(s)),key:"tick-".concat(f.coordinate)},cs(t,f,v)),a&&i.createElement("line",ue({className:"recharts-polar-angle-axis-tick-line"},m,N)),i.createElement(Qr,{tick:s,tickProps:P,value:r?r(f.value,v):f.value}))});return i.createElement(ie,{className:"recharts-polar-angle-axis-ticks"},h)},tn=t=>{var{angleAxisId:s}=t,a=H(Ke),r=H(c=>ye(c,"angleAxis",s)),l=us(),d=H(c=>tr(c,"angleAxis",s,l));if(a==null||!d||!d.length||r==null)return null;var o=X(X(X({},t),{},{scale:r},a),{},{radius:a.outerRadius,ticks:d});return i.createElement(Ue,{zIndex:o.zIndex},i.createElement(ie,{className:de("recharts-polar-angle-axis",Yr,o.className)},i.createElement(Xr,o),i.createElement(en,o)))};function _s(t){var s=qe(t,aa);return i.createElement(Vr,{id:s.angleAxisId,scale:s.scale,type:s.type,dataKey:s.dataKey,unit:void 0,name:s.name,allowDuplicatedCategory:!1,allowDataOverflow:!1,reversed:s.reversed,includeHidden:!1,allowDecimals:s.allowDecimals,tickCount:s.tickCount,ticks:s.ticks,tick:s.tick,domain:s.domain},i.createElement(tn,s))}_s.displayName="PolarAngleAxis";function Gt(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,r)}return a}function Be(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Gt(Object(a),!0).forEach(function(r){sn(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Gt(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function sn(t,s,a){return(s=an(s))in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function an(t){var s=rn(t,"string");return typeof s=="symbol"?s:s+""}function rn(t,s){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var Ss=(t,s)=>ye(t,"radiusAxis",s),nn=B([Ss],t=>{if(t!=null)return{scale:t}}),ln=B([rs,Ss],(t,s)=>{if(!(t==null||s==null))return Be(Be({},t),{},{scale:s})}),on=(t,s,a,r)=>Ne(t,"radiusAxis",s,r),ks=(t,s,a)=>lt(t,a),As=(t,s,a)=>ye(t,"angleAxis",a),dn=B([ks,As],(t,s)=>{if(!(t==null||s==null))return Be(Be({},t),{},{scale:s})}),cn=(t,s,a,r)=>Ne(t,"angleAxis",a,r),xn=B([ks,As,Ke],(t,s,a)=>{if(!(a==null||s==null))return{scale:s,type:t.type,dataKey:t.dataKey,cx:a.cx,cy:a.cy}}),mn=(t,s,a,r,l)=>l,un=B([ze,ln,on,dn,cn],(t,s,a,r,l)=>na(t,"radiusAxis")?_t(s,a,!1):_t(r,l,!1)),hn=B([Ea,mn],(t,s)=>{if(t!=null){var a=t.find(r=>r.type==="radar"&&s===r.id);return a==null?void 0:a.dataKey}}),gn=B([nn,xn,ra,hn,un],(t,s,a,r,l)=>{var{chartData:d,dataStartIndex:o,dataEndIndex:c}=a;if(!(t==null||s==null||d==null||l==null||r==null)){var m=d.slice(o,c+1);return Sn({radiusAxis:t,angleAxis:s,displayedData:m,dataKey:r,bandSize:l})}}),pn=["id"];function Ee(){return Ee=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},Ee.apply(null,arguments)}function Zt(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,r)}return a}function F(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Zt(Object(a),!0).forEach(function(r){bn(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Zt(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function bn(t,s,a){return(s=fn(s))in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function fn(t){var s=vn(t,"string");return typeof s=="symbol"?s:s+""}function vn(t,s){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function jn(t,s){if(t==null)return{};var a,r,l=yn(t,s);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(r=0;r<d.length;r++)a=d[r],s.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}function yn(t,s){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(s.indexOf(r)!==-1)continue;a[r]=t[r]}return a}function xt(t,s){return t&&t!=="none"?t:s}var Nn=t=>{var{dataKey:s,name:a,stroke:r,fill:l,legendType:d,hide:o}=t;return[{inactive:o,dataKey:s,type:d,color:xt(r,l),value:hs(a,s),payload:t}]},wn=i.memo(t=>{var{dataKey:s,stroke:a,strokeWidth:r,fill:l,name:d,hide:o,tooltipType:c,id:m}=t,h={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:a,strokeWidth:r,fill:l,nameKey:void 0,dataKey:s,name:hs(d,s),hide:o,type:c,color:xt(a,l),unit:"",graphicalItemId:m}};return i.createElement(da,{tooltipEntrySettings:h})});function _n(t){var{points:s,props:a}=t,{dot:r,dataKey:l}=a,{id:d}=a,o=jn(a,pn),c=Y(o);return i.createElement(ka,{points:s,dot:r,className:"recharts-radar-dots",dotClassName:"recharts-radar-dot",dataKey:l,baseProps:c})}function Sn(t){var{radiusAxis:s,angleAxis:a,displayedData:r,dataKey:l,bandSize:d}=t,{cx:o,cy:c}=a,m=!1,h=[],f=a.type!=="number"?d??0:0;r.forEach((N,k)=>{var g=St(N,a.dataKey,k),P=St(N,l),$=a.scale(g)+f,R=Array.isArray(P)?ca(P):P,j=kt(R)?0:s.scale(R);Array.isArray(P)&&P.length>=2&&(m=!0),h.push(F(F({},V(o,c,j,$)),{},{name:g,value:P,cx:o,cy:c,radius:j,angle:$,payload:N}))});var v=[];return m&&h.forEach(N=>{if(Array.isArray(N.value)){var k=N.value[0],g=kt(k)?0:s.scale(k);v.push(F(F({},N),{},{radius:g},V(o,c,g,N.angle)))}else v.push(N)}),{points:h,isRange:m,baseLinePoints:v}}function kn(t){var{showLabels:s,points:a,children:r}=t,l=a.map(d=>{var o,c={x:d.x,y:d.y,width:0,lowerWidth:0,upperWidth:0,height:0};return F(F({},c),{},{value:(o=d.value)!==null&&o!==void 0?o:"",payload:d.payload,parentViewBox:void 0,viewBox:c,fill:void 0})});return i.createElement(ha,{value:s?l:void 0},r)}function An(t){var{points:s,baseLinePoints:a,props:r}=t;if(s==null)return null;var{shape:l,isRange:d,connectNulls:o}=r,c=f=>{var{onMouseEnter:v}=r;v&&v(r,f)},m=f=>{var{onMouseLeave:v}=r;v&&v(r,f)},h;return i.isValidElement(l)?h=i.cloneElement(l,F(F({},r),{},{points:s})):typeof l=="function"?h=l(F(F({},r),{},{points:s})):h=i.createElement(vs,Ee({},ke(r),{onMouseEnter:c,onMouseLeave:m,points:s,baseLinePoints:d?a:void 0,connectNulls:o})),i.createElement(ie,{className:"recharts-radar-polygon"},h,i.createElement(_n,{props:r,points:s}))}var Jt=(t,s,a)=>(r,l)=>{var d=t&&t[Math.floor(l*s)];return d?F(F({},r),{},{x:Te(d.x,r.x,a),y:Te(d.y,r.y,a)}):F(F({},r),{},{x:Te(r.cx,r.x,a),y:Te(r.cy,r.y,a)})};function Pn(t){var{props:s,previousPointsRef:a,previousBaseLinePointsRef:r}=t,{points:l,baseLinePoints:d,isAnimationActive:o,animationBegin:c,animationDuration:m,animationEasing:h,onAnimationEnd:f,onAnimationStart:v}=s,N=a.current,k=r.current,g=N?N.length/l.length:1,P=k?k.length/d.length:1,$=xa(s,"recharts-radar-"),[R,j]=i.useState(!1),b=!R,E=i.useCallback(()=>{typeof f=="function"&&f(),j(!1)},[f]),x=i.useCallback(()=>{typeof v=="function"&&v(),j(!0)},[v]);return i.createElement(kn,{showLabels:b,points:l},i.createElement(ma,{animationId:$,begin:c,duration:m,isActive:o,easing:h,key:"radar-".concat($),onAnimationEnd:E,onAnimationStart:x},p=>{var y=p===1?l:l.map(Jt(N,g,p)),D=p===1?d:d==null?void 0:d.map(Jt(k,P,p));return p>0&&(a.current=y,r.current=D),i.createElement(An,{points:y,baseLinePoints:D,props:s})}),i.createElement(ua,{label:s.label}),s.children)}function Cn(t){var s=i.useRef(void 0),a=i.useRef(void 0);return i.createElement(Pn,{props:t,previousPointsRef:s,previousBaseLinePointsRef:a})}var Rn={activeDot:!0,angleAxisId:0,animationBegin:0,animationDuration:1500,animationEasing:"ease",dot:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",radiusAxisId:0,zIndex:ns.area};function On(t){var{hide:s,className:a,points:r}=t;if(s)return null;var l=de("recharts-radar",a);return i.createElement(Ue,{zIndex:t.zIndex},i.createElement(ie,{className:l},i.createElement(Cn,t)),i.createElement(Sa,{points:r,mainColor:xt(t.stroke,t.fill),itemDataKey:t.dataKey,activeDot:t.activeDot}))}function En(t){var s=us(),a=H(r=>gn(r,t.radiusAxisId,t.angleAxisId,s,t.id));return(a==null?void 0:a.points)==null?null:i.createElement(On,Ee({},t,{points:a==null?void 0:a.points,baseLinePoints:a==null?void 0:a.baseLinePoints,isRange:a==null?void 0:a.isRange}))}function Ps(t){var s=qe(t,Rn);return i.createElement(la,{id:s.id,type:"radar"},a=>i.createElement(i.Fragment,null,i.createElement(ia,{type:"radar",id:a,data:void 0,dataKey:s.dataKey,hide:s.hide,angleAxisId:s.angleAxisId,radiusAxisId:s.radiusAxisId}),i.createElement(oa,{legendPayload:Nn(s)}),i.createElement(wn,{dataKey:s.dataKey,stroke:s.stroke,strokeWidth:s.strokeWidth,fill:s.fill,name:s.name,hide:s.hide,tooltipType:s.tooltipType,id:a}),i.createElement(En,Ee({},s,{id:a}))))}Ps.displayName="Radar";function Xt(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,r)}return a}function Qt(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?Xt(Object(a),!0).forEach(function(r){Dn(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Xt(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Dn(t,s,a){return(s=Tn(s))in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Tn(t){var s=$n(t,"string");return typeof s=="symbol"?s:s+""}function $n(t,s){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,s);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}var In=["axis"],Ln=Qt(Qt({},Ta),{},{layout:"centric",startAngle:90,endAngle:-270}),Mn=i.forwardRef((t,s)=>{var a=qe(t,Ln);return i.createElement(Da,{chartName:"RadarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:In,tooltipPayloadSearcher:gs,categoricalChartProps:a,ref:s})}),Fn=["axis"],Bn=i.forwardRef((t,s)=>i.createElement(ga,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Fn,tooltipPayloadSearcher:gs,categoricalChartProps:t,ref:s}));function zn({children:t,selectedClient:s,selectedTeam:a,onChangeClient:r,onChangeTeam:l,showChangeButtons:d}){var $,R;const o=Ls(),{user:c,logout:m}=ts(),[h,f]=i.useState(!0),[v,N]=i.useState(0);i.useEffect(()=>{k(),g()},[]);const k=async()=>{try{const j=await L("/api/company/settings");if(j.ok){const b=await j.json();f(b.show_company_page)}}catch(j){console.error("Failed to fetch company settings:",j)}},g=async()=>{try{const j=await L("/api/am/dropout-requests");if(j.ok){const b=await j.json();N(b.length)}}catch(j){console.error("Failed to fetch pending dropouts:",j)}},P=[{path:"/am",icon:le,label:"Dashboard"},{path:"/am/roles",icon:We,label:"Roles"},{path:"/am/analytics",icon:ps,label:"Analytics"},{path:"/am/dropouts",icon:Ce,label:"Dropout Decisions"},{path:"/am/profile",icon:bs,label:"Profile"}];return h&&P.splice(3,0,{path:"/am/company",icon:ve,label:"Company"}),e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[e.jsxs("div",{className:"w-64 bg-white shadow-xl border-r border-slate-200",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-emerald-600 to-teal-600 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"EBES"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Account Manager"})]})]})}),e.jsx("div",{className:"px-4 py-3 border-b border-slate-200 bg-slate-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-lg flex items-center justify-center text-white font-semibold text-sm",children:(($=c==null?void 0:c.name)==null?void 0:$.charAt(0))||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800 truncate",children:c==null?void 0:c.name}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:c==null?void 0:c.user_code})]})]})}),(s||a)&&e.jsxs("div",{className:"p-4 border-b border-slate-200 space-y-3",children:[s&&e.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 text-emerald-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Client"})]}),d&&e.jsx("button",{onClick:r,className:"text-emerald-600 hover:text-emerald-700",title:"Change client",children:e.jsx(rt,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:s.client_code})]}),a&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Team"})]}),d&&e.jsx("button",{onClick:l,className:"text-blue-600 hover:text-blue-700",title:"Change team",children:e.jsx(rt,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:a.name}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:a.team_code})]})]}),e.jsxs("nav",{className:"mt-6 px-4",children:[P.map(j=>{const b=j.icon,E=o.pathname===j.path,x=j.path==="/am/dropouts";return e.jsxs(Ms,{to:j.path,className:`
                  flex items-center justify-between px-4 py-3 rounded-lg mb-2 transition-all duration-200
                  ${E?"bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg":"text-slate-600 hover:bg-slate-100 hover:text-slate-800"}
                `,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:j.label})]}),x&&v>0&&e.jsx("span",{className:"ml-auto px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full min-w-[20px] text-center",children:v})]},j.path)}),e.jsx("div",{className:"mt-8 pt-8 border-t border-slate-200",children:e.jsxs("button",{onClick:m,className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 transition-all duration-200",children:[e.jsx(Na,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Logout"})]})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:((R=P.find(j=>j.path===o.pathname))==null?void 0:R.label)||"Dashboard"}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(pa,{})})]})}),e.jsx("main",{className:"flex-1 overflow-auto p-6",children:t})]})]})}function Un({onClose:t,onRoleCreated:s}){const[a,r]=i.useState([]),[l,d]=i.useState([]),[o,c]=i.useState([]),[m,h]=i.useState(!1),[f,v]=i.useState(null),[N,k]=i.useState(null),[g,P]=i.useState({client_id:"",team_id:"",title:"",description:""});i.useEffect(()=>{$()},[]);const $=async()=>{try{const p=await L("/api/am/assignments");if(p.ok){const y=await p.json();r(y.clients||[]),d(y.teams||[])}}catch(p){console.error("Failed to fetch assignments:",p)}},R=()=>{const p=l.find(y=>y.id.toString()!==g.team_id&&!o.includes(y.id));p&&c([...o,p.id])},j=p=>{c(o.filter(y=>y!==p))},b=(p,y)=>{const D=[...o];D[p]=y,c(D)},E=async p=>{if(p.preventDefault(),!g.client_id||!g.team_id||!g.title){v("Please select a client, team, and provide a role title");return}h(!0),v(null);try{const y=[parseInt(g.team_id),...o],D=await L("/api/am/roles",{method:"POST",body:JSON.stringify({client_id:parseInt(g.client_id),team_id:parseInt(g.team_id),team_ids:y,title:g.title,description:g.description})});if(D.ok){const Z=await D.json();k(Z.role_code),setTimeout(()=>{s()},2e3)}else{const Z=await D.json();v(Z.error||"Failed to create role")}}catch{v("An error occurred while creating the role")}finally{h(!1)}},x=()=>{P({client_id:"",team_id:"",title:"",description:""}),v(null),k(null),t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:N?e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-green-500 text-5xl",children:"âœ“"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Role Created!"}),e.jsxs("div",{className:"bg-indigo-50 border-2 border-indigo-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Role Code"}),e.jsx("p",{className:"text-3xl font-bold text-indigo-600 font-mono",children:N})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 px-6 py-4 rounded-t-2xl flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white/20 rounded-lg p-2",children:e.jsx(We,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Create New Role"})]}),e.jsx("button",{onClick:x,className:"text-white hover:bg-white/20 rounded-full p-1.5 transition-colors",children:e.jsx(je,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:E,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Role Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:g.title,onChange:p=>P({...g,title:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,placeholder:"e.g., Senior Software Engineer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:g.description,onChange:p=>P({...g,description:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",rows:3,placeholder:"Brief description of the role"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(oe,{className:"w-4 h-4 inline mr-1"}),"Client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:g.client_id,onChange:p=>P({...g,client_id:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white",required:!0,children:[e.jsx("option",{value:"",children:"Select a client"}),a.map(p=>e.jsxs("option",{value:p.id,children:[p.name," (",p.client_code,")"]},p.id))]}),a.length===0&&e.jsx("p",{className:"text-sm text-amber-600 mt-1",children:"No clients assigned to you"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(G,{className:"w-4 h-4 inline mr-1"}),"Primary Team ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:g.team_id,onChange:p=>P({...g,team_id:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white",required:!0,children:[e.jsx("option",{value:"",children:"Select a team"}),l.map(p=>e.jsxs("option",{value:p.id,children:[p.name," (",p.team_code,")"]},p.id))]}),l.length===0&&e.jsx("p",{className:"text-sm text-amber-600 mt-1",children:"No teams assigned to you"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:[e.jsx(G,{className:"w-4 h-4 inline mr-1"}),"Additional Teams"]}),g.team_id&&l.filter(p=>p.id.toString()!==g.team_id&&!o.includes(p.id)).length>0&&e.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-1 text-xs bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded-lg hover:bg-indigo-100 transition-colors border border-indigo-200",children:[e.jsx(He,{className:"w-3 h-3"}),"Add Team"]})]}),o.length>0?e.jsx("div",{className:"space-y-2",children:o.map((p,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:p,onChange:D=>b(y,parseInt(D.target.value)),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white",children:l.filter(D=>D.id===p||D.id.toString()!==g.team_id&&!o.includes(D.id)).map(D=>e.jsxs("option",{value:D.id,children:[D.name," (",D.team_code,")"]},D.id))}),e.jsx("button",{type:"button",onClick:()=>j(p),className:"px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors border border-red-200",title:"Remove team",children:e.jsx(ot,{className:"w-4 h-4"})})]},y))}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No additional teams selected"})]}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:f}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:x,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m||a.length===0||l.length===0,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Creating...":"Create Role"})]})]})]})})})}function Kn({role:t,onClose:s,onRoleUpdated:a}){const[r,l]=i.useState([]),[d,o]=i.useState([]),[c,m]=i.useState([]),[h,f]=i.useState({title:t.title,description:t.description,client_id:t.client_id.toString(),team_id:t.team_id.toString()}),[v,N]=i.useState(!1),[k,g]=i.useState(null);i.useEffect(()=>{P(),t.additional_teams&&t.additional_teams.length>0&&m(t.additional_teams.map(x=>x.id))},[t]);const P=async()=>{try{const x=await L("/api/am/assignments");if(x.ok){const p=await x.json();l(p.clients||[]),o(p.teams||[])}}catch(x){console.error("Failed to fetch assignments:",x)}},$=()=>{const x=d.find(p=>p.id.toString()!==h.team_id&&!c.includes(p.id));x&&m([...c,x.id])},R=x=>{m(c.filter(p=>p!==x))},j=(x,p)=>{const y=[...c];y[x]=p,m(y)},b=async x=>{x.preventDefault(),N(!0),g(null);try{const p=[parseInt(h.team_id),...c],y=await L(`/api/am/roles/${t.id}`,{method:"PUT",body:JSON.stringify({title:h.title,description:h.description,client_id:parseInt(h.client_id),team_id:parseInt(h.team_id),team_ids:p})});if(y.ok)a();else{const D=await y.json();g(D.error||"Failed to update role")}}catch{g("An error occurred while updating the role")}finally{N(!1)}},E=d.filter(x=>x.id.toString()!==h.team_id&&!c.includes(x.id));return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 px-6 py-4 rounded-t-2xl flex justify-between items-center sticky top-0 z-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Edit Role"}),e.jsx("p",{className:"text-sm text-indigo-100 font-mono mt-1",children:t.role_code})]}),e.jsx("button",{onClick:s,className:"text-white hover:bg-white/20 rounded-full p-1.5 transition-colors",children:e.jsx(je,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:b,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Role Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:h.title,onChange:x=>f({...h,title:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:h.description,onChange:x=>f({...h,description:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(oe,{className:"w-4 h-4 inline mr-1"}),"Client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:h.client_id,onChange:x=>f({...h,client_id:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white",required:!0,children:r.map(x=>e.jsxs("option",{value:x.id,children:[x.name," (",x.client_code,")"]},x.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(G,{className:"w-4 h-4 inline mr-1"}),"Primary Team ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:h.team_id,onChange:x=>f({...h,team_id:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white",required:!0,children:d.map(x=>e.jsxs("option",{value:x.id,children:[x.name," (",x.team_code,")"]},x.id))})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:[e.jsx(G,{className:"w-4 h-4 inline mr-1"}),"Additional Teams"]}),E.length>0&&e.jsxs("button",{type:"button",onClick:$,className:"flex items-center gap-1 text-xs bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded-lg hover:bg-indigo-100 transition-colors border border-indigo-200",children:[e.jsx(He,{className:"w-3 h-3"}),"Add Team"]})]}),c.length>0?e.jsx("div",{className:"space-y-2",children:c.map((x,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:x,onChange:y=>j(p,parseInt(y.target.value)),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white",children:d.filter(y=>y.id===x||y.id.toString()!==h.team_id&&!c.includes(y.id)).map(y=>e.jsxs("option",{value:y.id,children:[y.name," (",y.team_code,")"]},y.id))}),e.jsx("button",{type:"button",onClick:()=>R(x),className:"px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors border border-red-200",title:"Remove team",children:e.jsx(ot,{className:"w-4 h-4"})})]},p))}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No additional teams assigned"})]}),k&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:k}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:v?"Updating...":"Update Role"})]})]})]})})}function qn({role:t,onClose:s,onRoleDeleted:a}){const[r,l]=i.useState(!1),[d,o]=i.useState(null),c=async()=>{l(!0),o(null);try{const m=await fetch(`/api/am/roles/${t.id}`,{method:"DELETE"});if(m.ok)a();else{const h=await m.json();o(h.error||"Failed to delete role")}}catch{o("An error occurred while deleting the role")}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Delete Role"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(je,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-900 mb-1",children:"Are you sure?"}),e.jsxs("p",{className:"text-sm text-red-700",children:["You are about to delete ",e.jsx("strong",{children:t.title})," (",t.role_code,"). This action cannot be undone and will remove all associated interview data."]})]})]})}),d&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm mb-4",children:d}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:c,disabled:r,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:r?"Deleting...":"Delete Role"})]})]})})}const Wn=[{value:"active",label:"Active",color:"bg-green-100 text-green-700"},{value:"lost",label:"Lost",color:"bg-red-100 text-red-700"},{value:"deal",label:"Deal",color:"bg-blue-100 text-blue-700"},{value:"on_hold",label:"On Hold",color:"bg-yellow-100 text-yellow-700"},{value:"cancelled",label:"Cancelled",color:"bg-gray-100 text-gray-700"},{value:"no_answer",label:"No Answer",color:"bg-purple-100 text-purple-700"}];function Hn({role:t,onClose:s,onStatusChanged:a}){const[r,l]=i.useState(t.status),[d,o]=i.useState(!1),[c,m]=i.useState(null),h=async f=>{if(f.preventDefault(),r===t.status){s();return}o(!0),m(null);try{const v=await L(`/api/am/roles/${t.id}`,{method:"PUT",body:JSON.stringify({status:r})});if(v.ok)a();else{const N=await v.json();m(N.error||"Failed to update status")}}catch{m("An error occurred while updating the status")}finally{o(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Change Status"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500 font-mono mt-0.5",children:t.role_code})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(je,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:Wn.map(f=>e.jsx("button",{type:"button",onClick:()=>l(f.value),className:`w-full p-3 rounded-lg border-2 transition-all text-left ${r===f.value?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:f.label}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${f.color}`,children:f.label})]})},f.value))}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:c}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d||r===t.status,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:d?"Updating...":"Update Status"})]})]})]})})}function Yn({role:t,onClose:s,onInterviewAdded:a}){const[r,l]=i.useState(1),[d,o]=i.useState(1),[c,m]=i.useState(!1),[h,f]=i.useState(null),v=async k=>{k.preventDefault(),m(!0),f(null);try{const g=await fetch(`/api/am/roles/${t.id}/interviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({interview_round:r,interview_count:d})});if(g.ok)a();else{const P=await g.json();f(P.error||"Failed to add interview entry")}}catch{f("An error occurred while adding the interview entry")}finally{m(!1)}},N=[{value:1,label:"1st Interview (First Round)",current:t.interview_1_count},{value:2,label:"2nd Interview (Second Round)",current:t.interview_2_count},{value:3,label:"3rd Interview (Final Round)",current:t.interview_3_count}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Add Interview Entry"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500 font-mono mt-0.5",children:t.role_code})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(je,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-sm text-indigo-700 font-medium mb-2",children:"Current Interview Count"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-indigo-600",children:t.interview_1_count}),e.jsx("p",{className:"text-xs text-indigo-700",children:"1st Round"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-indigo-600",children:t.interview_2_count}),e.jsx("p",{className:"text-xs text-indigo-700",children:"2nd Round"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-indigo-600",children:t.interview_3_count}),e.jsx("p",{className:"text-xs text-indigo-700",children:"Final"})]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-indigo-200",children:e.jsxs("p",{className:"text-xs text-indigo-700 text-center",children:["Total: ",e.jsx("span",{className:"font-bold",children:t.total_interviews})]})})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Interview Round *"}),e.jsx("div",{className:"space-y-2",children:N.map(k=>e.jsx("button",{type:"button",onClick:()=>l(k.value),className:`w-full p-3 rounded-lg border-2 transition-all text-left ${r===k.value?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:k.label}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Current: ",e.jsx("strong",{children:k.current})]})]})},k.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Interviews *"}),e.jsx("input",{type:"number",value:d,onChange:k=>o(parseInt(k.target.value,10)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",min:"1",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How many interviews to add for this round"})]}),h&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:h}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:c?"Adding...":"Add Entry"})]})]})]})})}function Vn({role:t,onEdit:s,onDelete:a,onChangeStatus:r,onAddInterview:l}){const d={active:"bg-green-100 text-green-700 border-green-200",lost:"bg-red-100 text-red-700 border-red-200",deal:"bg-blue-100 text-blue-700 border-blue-200",on_hold:"bg-yellow-100 text-yellow-700 border-yellow-200",cancelled:"bg-gray-100 text-gray-700 border-gray-200",no_answer:"bg-purple-100 text-purple-700 border-purple-200"},o={active:"Active",lost:"Lost",deal:"Deal",on_hold:"On Hold",cancelled:"Cancelled",no_answer:"No Answer"};return e.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:t.title}),t.has_pending_dropout&&e.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-semibold rounded border border-orange-200",children:"Pending"}),t.has_dropout&&e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-semibold rounded border border-red-200",children:"Dropped Out"})]}),e.jsx("p",{className:"text-xs text-gray-600 font-mono",children:t.role_code})]}),e.jsx("div",{className:`px-3 py-1 rounded-full border text-xs font-medium ${d[t.status]}`,children:o[t.status]})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3 mb-3 border border-indigo-100",children:[e.jsx("p",{className:"text-xs text-indigo-700 mb-1 font-semibold",children:"Submissions"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:t.total_submissions})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2 font-medium",children:"Interview Progress"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-indigo-600",children:t.interview_1_count}),e.jsx("p",{className:"text-xs text-gray-500",children:"1st Round"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-indigo-600",children:t.interview_2_count}),e.jsx("p",{className:"text-xs text-gray-500",children:"2nd Round"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-indigo-600",children:t.interview_3_count}),e.jsx("p",{className:"text-xs text-gray-500",children:"Final"})]})]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-600 text-center",children:["Total Interviews: ",e.jsx("span",{className:"font-bold text-gray-900",children:t.total_interviews})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:s,className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",title:"Edit role",children:[e.jsx(wa,{className:"w-3 h-3"}),"Edit"]}),e.jsxs("button",{onClick:r,className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",title:"Change status",children:[e.jsx(rt,{className:"w-3 h-3"}),"Status"]}),e.jsxs("button",{onClick:l,className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 text-sm bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",title:"Add interview entry",children:[e.jsx(He,{className:"w-3 h-3"}),"Entry"]}),e.jsx("button",{onClick:a,className:"px-3 py-2 text-sm text-red-600 border border-red-200 rounded-lg hover:bg-red-50 transition-colors",title:"Delete role",children:e.jsx(ot,{className:"w-3 h-3"})})]})]})}function Gn({clientId:t,teamId:s}){const[a,r]=i.useState("active"),[l,d]=i.useState([]),[o,c]=i.useState(!0),[m,h]=i.useState(!1),[f,v]=i.useState(null),[N,k]=i.useState(null),[g,P]=i.useState(null),[$,R]=i.useState(null);i.useEffect(()=>{j()},[a,t,s]);const j=async()=>{c(!0);try{const x=new URLSearchParams({status:a,client_id:t.toString(),team_id:s.toString()}),p=await L(`/api/am/roles?${x}`);if(p.ok){const y=await p.json();d(y)}}catch(x){console.error("Failed to fetch roles:",x)}finally{c(!1)}},b=a==="active"?l.length:0,E=b>=25;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Role Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage roles and track interview progress"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[e.jsx(He,{className:"w-4 h-4"}),"Create Role"]})]}),E&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-yellow-800 font-medium",children:["âš ï¸ You have ",b," active roles. You can have a maximum of 30 active roles. Please update role statuses to free up slots."]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>r("active"),className:`flex-1 px-6 py-4 font-medium transition-colors ${a==="active"?"text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:"Active Roles"}),e.jsx("button",{onClick:()=>r("non-active"),className:`flex-1 px-6 py-4 font-medium transition-colors ${a==="non-active"?"text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:"Non-Active Roles"})]})}),e.jsx("div",{className:"p-6",children:o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(We,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-500",children:["No ",a==="active"?"active":"non-active"," roles found"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create a new role to get started"})]}):a==="active"?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:l.map(x=>e.jsx(Vn,{role:x,onEdit:()=>v(x),onDelete:()=>k(x),onChangeStatus:()=>P(x),onAddInterview:()=>R(x)},x.id))}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Role Code"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Title"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-700",children:"Int 1"}),e.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-700",children:"Int 2"}),e.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-700",children:"Int 3"}),e.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-700",children:"Total"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(x=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-indigo-600",children:x.role_code}),x.has_dropout&&e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-semibold rounded border border-red-200",children:"Dropped Out"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:x.title}),x.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:x.description})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${x.status==="deal"?"bg-green-100 text-green-700 border border-green-200":x.status==="lost"?"bg-red-100 text-red-700 border border-red-200":x.status==="on_hold"?"bg-yellow-100 text-yellow-700 border border-yellow-200":x.status==="cancelled"?"bg-gray-100 text-gray-700 border border-gray-200":x.status==="no_answer"?"bg-orange-100 text-orange-700 border border-orange-200":"bg-blue-100 text-blue-700 border border-blue-200"}`,children:x.status==="deal"?"Deal":x.status==="lost"?"Lost":x.status==="on_hold"?"On Hold":x.status==="cancelled"?"Cancelled":x.status==="no_answer"?"No Answer":x.status})}),e.jsx("td",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:x.interview_1_count}),e.jsx("td",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:x.interview_2_count}),e.jsx("td",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:x.interview_3_count}),e.jsx("td",{className:"text-center py-3 px-4 font-semibold text-indigo-600",children:x.total_interviews}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>R(x),className:"px-3 py-1 text-xs bg-teal-50 text-teal-700 hover:bg-teal-100 rounded border border-teal-200 transition-colors",title:"Add Interview",children:"+ Interview"}),e.jsx("button",{onClick:()=>P(x),className:"px-3 py-1 text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 rounded border border-blue-200 transition-colors",title:"Change Status",children:"Status"}),e.jsx("button",{onClick:()=>v(x),className:"px-3 py-1 text-xs bg-gray-50 text-gray-700 hover:bg-gray-100 rounded border border-gray-200 transition-colors",title:"Edit",children:"Edit"}),e.jsx("button",{onClick:()=>k(x),className:"px-3 py-1 text-xs bg-red-50 text-red-700 hover:bg-red-100 rounded border border-red-200 transition-colors",title:"Delete",children:"Delete"})]})})]},x.id))})]})})})]}),m&&e.jsx(Un,{onClose:()=>h(!1),onRoleCreated:()=>{j(),h(!1)}}),f&&e.jsx(Kn,{role:f,onClose:()=>v(null),onRoleUpdated:()=>{j(),v(null)}}),N&&e.jsx(qn,{role:N,onClose:()=>k(null),onRoleDeleted:()=>{j(),k(null)}}),g&&e.jsx(Hn,{role:g,onClose:()=>P(null),onStatusChanged:()=>{j(),P(null)}}),$&&e.jsx(Yn,{role:$,onClose:()=>R(null),onInterviewAdded:()=>{j(),R(null)}})]})}function Zn({client:t,onClose:s}){const a=l=>{switch(l){case"Strong":return"from-green-500 to-green-600";case"Average":return"from-yellow-500 to-yellow-600";case"At Risk":return"from-red-500 to-red-600";default:return"from-gray-500 to-gray-600"}},r=t.interview_1+t.interview_2;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:`sticky top-0 bg-gradient-to-r ${a(t.health)} px-6 py-5 flex justify-between items-center rounded-t-2xl`,children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:t.client_name}),e.jsx("p",{className:"text-sm text-white text-opacity-90 mt-1 font-mono",children:t.client_code})]}),e.jsx("button",{onClick:s,className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors",children:e.jsx(je,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:`p-6 bg-gradient-to-br ${t.health==="Strong"?"from-green-50 to-green-100 border-green-200":t.health==="Average"?"from-yellow-50 to-yellow-100 border-yellow-200":"from-red-50 to-red-100 border-red-200"} rounded-lg border-2`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Client Health Status"}),e.jsx("p",{className:`text-3xl font-bold ${t.health==="Strong"?"text-green-700":t.health==="Average"?"text-yellow-700":"text-red-700"}`,children:t.health})]}),e.jsxs("div",{className:"text-5xl",children:[t.health==="Strong"&&"ðŸ’ª",t.health==="Average"&&"ðŸ“Š",t.health==="At Risk"&&"âš ï¸"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg p-4 border border-indigo-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(We,{className:"w-5 h-5 text-indigo-600"}),e.jsx("p",{className:"text-xs font-semibold text-indigo-900",children:"Total Roles"})]}),e.jsx("p",{className:"text-3xl font-bold text-indigo-700",children:t.total_roles})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ve,{className:"w-5 h-5 text-blue-600"}),e.jsx("p",{className:"text-xs font-semibold text-blue-900",children:"Active"})]}),e.jsx("p",{className:"text-3xl font-bold text-blue-700",children:t.active_roles})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-lg p-4 border border-teal-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(G,{className:"w-5 h-5 text-teal-600"}),e.jsx("p",{className:"text-xs font-semibold text-teal-900",children:"Interviews"})]}),e.jsx("p",{className:"text-3xl font-bold text-teal-700",children:r})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"w-5 h-5 text-green-600"}),e.jsx("p",{className:"text-xs font-semibold text-green-900",children:"Deals"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-700",children:t.deals})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("h4",{className:"font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(Ua,{className:"w-5 h-5 text-slate-600"}),"Interview Breakdown"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border border-slate-200",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Level 1"}),e.jsx("p",{className:"text-2xl font-bold text-teal-600",children:t.interview_1})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border border-slate-200",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Level 2"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.interview_2})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsx("h4",{className:"font-semibold text-slate-800 mb-4",children:"Role Status Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(se,{className:"w-4 h-4 text-green-600"}),e.jsx("p",{className:"text-xs font-medium text-slate-700",children:"Deals"})]}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:t.deals})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(at,{className:"w-4 h-4 text-red-600"}),e.jsx("p",{className:"text-xs font-medium text-slate-700",children:"Lost"})]}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:t.lost})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Fe,{className:"w-4 h-4 text-yellow-600"}),e.jsx("p",{className:"text-xs font-medium text-slate-700",children:"On Hold"})]}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:t.on_hold})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ae,{className:"w-4 h-4 text-orange-600"}),e.jsx("p",{className:"text-xs font-medium text-slate-700",children:"No Answer"})]}),e.jsx("p",{className:"text-xl font-bold text-orange-600",children:t.no_answer})]}),t.cancelled!==void 0&&e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(at,{className:"w-4 h-4 text-gray-600"}),e.jsx("p",{className:"text-xs font-medium text-slate-700",children:"Cancelled"})]}),e.jsx("p",{className:"text-xl font-bold text-gray-600",children:t.cancelled})]})]})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4 border border-indigo-200",children:[e.jsx("h4",{className:"font-semibold text-indigo-900 mb-3",children:"Performance Insights"}),e.jsxs("div",{className:"space-y-2 text-sm text-indigo-800",children:[t.deals>0&&e.jsxs("p",{children:["âœ“ Successfully closed ",t.deals," ",t.deals===1?"deal":"deals"]}),t.active_roles>0&&e.jsxs("p",{children:["â€¢ Currently managing ",t.active_roles," active ",t.active_roles===1?"role":"roles"]}),r>0&&e.jsxs("p",{children:["â€¢ Conducted ",r," ",r===1?"interview":"interviews"," across all levels"]}),t.lost>0&&e.jsxs("p",{className:"text-red-700",children:["âš  ",t.lost," ",t.lost===1?"role":"roles"," marked as lost"]}),t.no_answer>0&&e.jsxs("p",{className:"text-orange-700",children:["âš  ",t.no_answer," ",t.no_answer===1?"role":"roles"," with no answer"]})]})]})]})]})})}const K={primary:"#6366f1",success:"#10b981",warning:"#f59e0b",danger:"#ef4444",info:"#3b82f6",purple:"#8b5cf6",pink:"#ec4899"};function Jn(){var ht,gt,pt,bt,ft,vt,jt,yt,Nt,wt;const[t,s]=i.useState(!0),[a,r]=i.useState(0),[l,d]=i.useState("Average"),[o,c]=i.useState(null),[m,h]=i.useState([]),[f,v]=i.useState([]),[N,k]=i.useState([]),[g,P]=i.useState("all"),[$,R]=i.useState("all"),[j,b]=i.useState("current"),[E,x]=i.useState(""),[p,y]=i.useState(""),[D,Z]=i.useState(!1),[ce,De]=i.useState(null),[we,mt]=i.useState(!1);i.useEffect(()=>{Cs()},[]),i.useEffect(()=>{Es(),Rs()},[g,$,j,E,p]);const Cs=async()=>{try{const n=await L("/api/am/assignments");if(n.ok){const u=await n.json();v(u.clients),k(u.teams)}}catch(n){console.error("Failed to fetch assignments:",n)}},Rs=async()=>{const n=[],u=new Date;for(let I=5;I>=0;I--){const C=new Date(u.getFullYear(),u.getMonth()-I,1),_=`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}`;try{const w=`${_}-01`,_e=new Date(C.getFullYear(),C.getMonth()+1,0).getDate(),xe=`${_}-${_e}`,ne=new URLSearchParams;ne.append("start_date",w),ne.append("end_date",xe);const pe=await L(`/api/am/ebes-score?${ne.toString()}`),be=await L(`/api/am/analytics?${ne.toString()}`);let M=0,S=0,Q=0,ee=0;if(pe.ok&&(M=(await pe.json()).score),be.ok){const U=await be.json();S=U.clients.reduce((T,A)=>T+A.total_roles,0),Q=U.clients.reduce((T,A)=>T+A.deal_roles,0),ee=U.clients.reduce((T,A)=>T+A.total_interviews,0)}n.push({month:C.toLocaleDateString("en-US",{month:"short"}),ebes:M,roles:S,deals:Q,interviews:ee,conversion:S>0?Math.round(Q/S*100):0})}catch{console.error("Failed to fetch trend for month:",_)}}h(n)},Os=async(n,u)=>{const I=n.fields&&n.fields.length>0?n.fields:["user_info","ebes_score","teams","clients","total_roles","active_roles","interviews_1","interviews_2","total_interviews","deals","lost_roles","on_hold_roles","no_answer_roles"],C=new URLSearchParams;if(n.clientId&&n.clientId!=="all"&&C.append("client_id",n.clientId),n.teamId&&n.teamId!=="all"&&C.append("team_id",n.teamId),n.dateRange==="custom"&&n.startDate&&n.endDate)C.append("start_date",n.startDate),C.append("end_date",n.endDate);else if(n.dateRange&&n.dateRange!=="all")if(n.dateRange==="today"){const M=new Date().toISOString().split("T")[0];C.append("start_date",M),C.append("end_date",M)}else{const S={week:"this_week",month:"this_month"}[n.dateRange];S&&C.append("date_range",S)}let _=null;try{const M=await L(`/api/am/performance?${C.toString()}`);M.ok&&(_=await M.json())}catch{}const w=(_==null?void 0:_.overview)||{total_roles:0,active_roles:0,interview_1_count:0,interview_2_count:0,total_interviews:0,total_deals:0,total_lost:0,total_on_hold:0,total_no_answer:0,ebes_score:a||0,performance_label:l||""},_e=localStorage.getItem("user")||"{}";let xe="",ne="",pe="";try{const M=JSON.parse(_e);xe=M.name||"",ne=M.user_code||"",pe=M.email||""}catch{}const be={user_info:["Name","User Code","Email"],ebes_score:["EBES Score","Performance"],teams:["Teams"],clients:["Clients"],total_roles:["Total Roles"],active_roles:["Active Roles"],interviews_1:["Interview 1"],interviews_2:["Interview 2"],total_interviews:["Total Interviews"],deals:["Deals"],lost_roles:["Lost"],on_hold_roles:["On Hold"],no_answer_roles:["No Answer"]};if(u==="csv"){const M=[];I.forEach(T=>{const A=be[T];A&&M.push(...A)});const S=[];I.forEach(T=>{T==="user_info"?S.push(`"${xe}"`,ne,pe):T==="ebes_score"?S.push(String(w.ebes_score||0),w.performance_label||""):T==="teams"?S.push(`"${N.map(A=>A.name).join("; ")}"`):T==="clients"?S.push(`"${f.map(A=>A.name).join("; ")}"`):T==="total_roles"?S.push(String(w.total_roles||0)):T==="active_roles"?S.push(String(w.active_roles||0)):T==="interviews_1"?S.push(String(w.interview_1_count||0)):T==="interviews_2"?S.push(String(w.interview_2_count||0)):T==="total_interviews"?S.push(String(w.total_interviews||0)):T==="deals"?S.push(String(w.total_deals||0)):T==="lost_roles"?S.push(String(w.total_lost||0)):T==="on_hold_roles"?S.push(String(w.total_on_hold||0)):T==="no_answer_roles"&&S.push(String(w.total_no_answer||0))});const Q=new Blob([[M.join(","),S.join(",")].join(`
`)],{type:"text/csv;charset=utf-8;"}),ee=URL.createObjectURL(Q),U=document.createElement("a");U.href=ee,U.download=`am-report-${new Date().toISOString().split("T")[0]}.csv`,U.click(),URL.revokeObjectURL(ee)}else if(u==="excel"){const M=[];I.forEach(A=>{const te=be[A];te&&M.push(...te)});const S=[];I.forEach(A=>{A==="total_roles"?S.push(String(w.total_roles||0)):A==="active_roles"?S.push(String(w.active_roles||0)):A==="interviews_1"?S.push(String(w.interview_1_count||0)):A==="interviews_2"?S.push(String(w.interview_2_count||0)):A==="total_interviews"?S.push(String(w.total_interviews||0)):A==="deals"?S.push(String(w.total_deals||0)):A==="lost_roles"?S.push(String(w.total_lost||0)):A==="on_hold_roles"?S.push(String(w.total_on_hold||0)):A==="no_answer_roles"&&S.push(String(w.total_no_answer||0))});const Q=[`"AM Report - ${new Date().toLocaleDateString()}"`,"",M.join(","),S.join(",")],ee=new Blob([Q.join(`
`)],{type:"application/vnd.ms-excel;charset=utf-8;"}),U=URL.createObjectURL(ee),T=document.createElement("a");T.href=U,T.download=`am-report-${new Date().toISOString().split("T")[0]}.csv`,T.click(),URL.revokeObjectURL(U)}else{const M=[];I.forEach(A=>{const te=be[A];te&&M.push(...te)});const S=[];I.forEach(A=>{A==="user_info"?S.push(`"${xe}"`,ne,pe):A==="ebes_score"?S.push(String(w.ebes_score||0),w.performance_label||""):A==="teams"?S.push(`"${N.map(te=>te.name).join("; ")}"`):A==="clients"?S.push(`"${f.map(te=>te.name).join("; ")}"`):A==="total_roles"?S.push(String(w.total_roles||0)):A==="active_roles"?S.push(String(w.active_roles||0)):A==="interviews_1"?S.push(String(w.interview_1_count||0)):A==="interviews_2"?S.push(String(w.interview_2_count||0)):A==="total_interviews"?S.push(String(w.total_interviews||0)):A==="deals"?S.push(String(w.total_deals||0)):A==="lost_roles"?S.push(String(w.total_lost||0)):A==="on_hold_roles"?S.push(String(w.total_on_hold||0)):A==="no_answer_roles"&&S.push(String(w.total_no_answer||0))});const Q=`<!doctype html><html><head><meta charset="utf-8"><title>AM Report</title></head><body><h2>Account Manager Report</h2><table style="border-collapse:collapse;width:100%"><thead><tr>${M.map(A=>`<th style="padding:8px;border:1px solid #ddd;text-align:left">${A}</th>`).join("")}</tr></thead><tbody><tr>${S.map(A=>`<td style="padding:8px;border:1px solid #ddd;">${A}</td>`).join("")}</tr></tbody></table></body></html>`,ee=new Blob([Q],{type:"text/html"}),U=URL.createObjectURL(ee),T=window.open(U);T&&T.addEventListener("load",()=>{T.print()})}},Es=async()=>{s(!0);try{const n=new URLSearchParams;if(j==="current"){const C=new Date,_=new Date(C.getFullYear(),C.getMonth(),1),w=new Date(C.getFullYear(),C.getMonth()+1,0);n.append("start_date",_.toISOString().split("T")[0]),n.append("end_date",w.toISOString().split("T")[0])}else if(j==="last"){const C=new Date,_=new Date(C.getFullYear(),C.getMonth()-1,1),w=new Date(C.getFullYear(),C.getMonth(),0);n.append("start_date",_.toISOString().split("T")[0]),n.append("end_date",w.toISOString().split("T")[0])}else j==="custom"&&E&&p&&(n.append("start_date",E),n.append("end_date",p));const u=await L(`/api/am/ebes-score?${n.toString()}`);if(u.ok){const C=await u.json();r(C.score),d(C.performance_label)}const I=await L(`/api/am/analytics?${n.toString()}`);if(I.ok){const C=await I.json();c(C)}}catch(n){console.error("Failed to fetch data:",n)}finally{s(!1)}},Ds=()=>{if(j==="current")return`Current Month - ${new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"})}`;if(j==="last"){const n=new Date;return n.setMonth(n.getMonth()-1),`Last Month - ${n.toLocaleDateString("en-US",{month:"long",year:"numeric"})}`}else if(j==="custom"&&E&&p)return`${new Date(E).toLocaleDateString()} - ${new Date(p).toLocaleDateString()}`;return"Select Date Range"},Ts=()=>l==="Excellent"?"from-green-500 to-emerald-600":l==="Strong"?"from-blue-500 to-indigo-600":l==="At Risk"?"from-red-500 to-rose-600":"from-yellow-500 to-amber-600",O=((ht=o==null?void 0:o.clients)==null?void 0:ht.filter(n=>!(g!=="all"&&n.client_id.toString()!==g)))||[],ut=o?[{name:"Active",value:O.reduce((n,u)=>n+u.active_roles,0),color:K.success},{name:"Deals",value:O.reduce((n,u)=>n+u.deal_roles,0),color:K.primary},{name:"Lost",value:O.reduce((n,u)=>n+u.lost_roles,0),color:K.danger},{name:"On Hold",value:O.reduce((n,u)=>n+u.on_hold_roles,0),color:K.warning},{name:"Cancelled",value:O.reduce((n,u)=>n+u.cancelled_roles,0),color:K.purple},{name:"No Answer",value:O.reduce((n,u)=>n+u.no_answer_roles,0),color:K.pink}].filter(n=>n.value>0):[],J=o?[{stage:"Level 1",count:O.reduce((n,u)=>n+u.interview_1_count,0)},{stage:"Level 2",count:O.reduce((n,u)=>n+u.interview_2_count,0)},{stage:"Level 3",count:O.reduce((n,u)=>n+u.interview_3_count,0)},{stage:"Deals",count:O.reduce((n,u)=>n+u.deal_roles,0)}]:[],$s=O.sort((n,u)=>u.deal_roles-n.deal_roles).slice(0,5).map(n=>({name:n.client_code,deals:n.deal_roles,interviews:n.total_interviews,conversion:n.roles_to_deal_conversion})),Is=o?[{metric:"Deals",value:Math.min(100,O.reduce((n,u)=>n+u.deal_roles,0)/Math.max(O.reduce((n,u)=>n+u.total_roles,0),1)*100)},{metric:"Interviews",value:Math.min(100,O.reduce((n,u)=>n+u.total_interviews,0)/Math.max(O.reduce((n,u)=>n+u.total_roles,0)*3,1)*100)},{metric:"Active Roles",value:Math.min(100,O.reduce((n,u)=>n+u.active_roles,0)/Math.max(O.reduce((n,u)=>n+u.total_roles,0),1)*100)},{metric:"Response",value:Math.min(100,100-O.reduce((n,u)=>n+u.no_answer_roles,0)/Math.max(O.reduce((n,u)=>n+u.total_roles,0),1)*100)},{metric:"Retention",value:Math.min(100,100-O.reduce((n,u)=>n+u.lost_roles+u.cancelled_roles,0)/Math.max(O.reduce((n,u)=>n+u.total_roles,0),1)*100)}]:[],Ye=(n,u)=>{if(u===0)return{icon:Tt,color:"text-gray-400",text:"N/A"};const I=(n-u)/u*100;return I>0?{icon:Ba,color:"text-green-600",text:`+${I.toFixed(1)}%`}:I<0?{icon:Ma,color:"text-red-600",text:`${I.toFixed(1)}%`}:{icon:Tt,color:"text-gray-400",text:"0%"}};if(t)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})});const z=O.reduce((n,u)=>n+u.total_roles,0),ge=O.reduce((n,u)=>n+u.total_interviews,0),re=O.reduce((n,u)=>n+u.deal_roles,0),q=z>0?re/z*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Advanced Performance Analytics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights and data visualization"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>Z(!D),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all shadow-lg",children:[e.jsx(At,{className:"w-4 h-4"}),"Filters"]}),e.jsxs("button",{onClick:()=>mt(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-all font-medium shadow-lg",children:[e.jsx(ba,{className:"w-4 h-4"}),"Download Report"]})]})]}),D&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-indigo-100 p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(At,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filter Options"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsx("button",{onClick:()=>b("current"),className:`px-6 py-2 rounded-lg font-medium transition-all ${j==="current"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Current Month"}),e.jsx("button",{onClick:()=>b("last"),className:`px-6 py-2 rounded-lg font-medium transition-all ${j==="last"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last Month"}),e.jsx("button",{onClick:()=>b("custom"),className:`px-6 py-2 rounded-lg font-medium transition-all ${j==="custom"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Custom Range"})]}),j==="custom"&&e.jsxs("div",{className:"flex flex-wrap items-end gap-4 p-4 bg-indigo-50 rounded-lg border border-indigo-200",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:E,onChange:n=>x(n.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:p,onChange:n=>y(n.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),e.jsxs("p",{className:"text-sm text-indigo-600 mt-2 font-medium",children:[e.jsx(it,{className:"w-4 h-4 inline mr-1"}),Ds()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client"}),e.jsxs("select",{value:g,onChange:n=>P(n.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"all",children:"All Clients"}),f.map(n=>e.jsxs("option",{value:n.id.toString(),children:[n.name," (",n.client_code,")"]},n.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team"}),e.jsxs("select",{value:$,onChange:n=>R(n.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"all",children:"All Teams"}),N.map(n=>e.jsxs("option",{value:n.id.toString(),children:[n.name," (",n.team_code,")"]},n.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:`bg-gradient-to-br ${Ts()} rounded-2xl shadow-xl p-6 text-white col-span-1 md:col-span-2 lg:col-span-1`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(st,{className:"w-8 h-8 text-white/80"}),e.jsx("span",{className:"text-xs font-semibold bg-white/20 px-3 py-1 rounded-full",children:l})]}),e.jsx(fs,{type:"ebes",score:a,label:l,className:"text-white"}),e.jsx("p",{className:"text-sm text-white/80 mt-2",children:"EBES Score"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-blue-100 p-6 hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(le,{className:"w-8 h-8 text-blue-600"}),e.jsx(Pt,{className:"w-5 h-5 text-blue-400"})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:z}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Roles"}),e.jsx("div",{className:"mt-2 flex items-center gap-1 text-xs",children:(()=>{const n=(o==null?void 0:o.clients.reduce((C,_)=>{var w;return C+(((w=_.last_month)==null?void 0:w.roles_created)||0)},0))||0,u=Ye(z,n),I=u.icon;return e.jsxs(e.Fragment,{children:[e.jsx(I,{className:`w-3 h-3 ${u.color}`}),e.jsx("span",{className:u.color,children:u.text}),e.jsx("span",{className:"text-gray-400",children:"vs last period"})]})})()})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-purple-100 p-6 hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(G,{className:"w-8 h-8 text-purple-600"}),e.jsx(Ct,{className:"w-5 h-5 text-purple-400"})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:ge}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Interviews"}),e.jsx("div",{className:"mt-2 flex items-center gap-1 text-xs",children:(()=>{const n=(o==null?void 0:o.clients.reduce((C,_)=>{var w;return C+(((w=_.last_month)==null?void 0:w.interviews)||0)},0))||0,u=Ye(ge,n),I=u.icon;return e.jsxs(e.Fragment,{children:[e.jsx(I,{className:`w-3 h-3 ${u.color}`}),e.jsx("span",{className:u.color,children:u.text}),e.jsx("span",{className:"text-gray-400",children:"vs last period"})]})})()})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-green-100 p-6 hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(se,{className:"w-8 h-8 text-green-600"}),e.jsx(qa,{className:"w-5 h-5 text-green-400"})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:re}),e.jsx("p",{className:"text-sm text-gray-600",children:"Closed Deals"}),e.jsx("div",{className:"mt-2 flex items-center gap-1 text-xs",children:(()=>{const n=(o==null?void 0:o.clients.reduce((C,_)=>{var w;return C+(((w=_.last_month)==null?void 0:w.deals)||0)},0))||0,u=Ye(re,n),I=u.icon;return e.jsxs(e.Fragment,{children:[e.jsx(I,{className:`w-3 h-3 ${u.color}`}),e.jsx("span",{className:u.color,children:u.text}),e.jsx("span",{className:"text-gray-400",children:"vs last period"})]})})()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(ve,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"6-Month Performance Trend"})]}),e.jsx(Se,{width:"100%",height:300,children:e.jsxs(Bn,{data:m,children:[e.jsx(Ve,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Ge,{dataKey:"month",stroke:"#6b7280"}),e.jsx($e,{yAxisId:"left",stroke:"#6b7280"}),e.jsx($e,{yAxisId:"right",orientation:"right",stroke:"#6b7280"}),e.jsx(Ie,{contentStyle:{backgroundColor:"#fff",border:"2px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(Dt,{}),e.jsx(Le,{yAxisId:"left",dataKey:"deals",fill:K.success,name:"Deals",radius:[8,8,0,0]}),e.jsx(Aa,{yAxisId:"right",type:"monotone",dataKey:"ebes",stroke:K.primary,strokeWidth:3,name:"EBES Score",dot:{r:5}})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(ps,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Role Status Distribution"})]}),e.jsx(Se,{width:"100%",height:300,children:e.jsxs($a,{children:[e.jsx(Ia,{data:ut,cx:"50%",cy:"50%",labelLine:!1,label:n=>`${n.name}: ${n.value}`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:ut.map((n,u)=>e.jsx(fa,{fill:n.color},`cell-${u}`))}),e.jsx(Ie,{})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ct,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Interview Conversion Funnel"})]}),e.jsx(Se,{width:"100%",height:300,children:e.jsxs(Rt,{data:J,layout:"vertical",children:[e.jsx(Ve,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Ge,{type:"number",stroke:"#6b7280"}),e.jsx($e,{dataKey:"stage",type:"category",stroke:"#6b7280"}),e.jsx(Ie,{contentStyle:{backgroundColor:"#fff",border:"2px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(Le,{dataKey:"count",fill:K.info,radius:[0,8,8,0]})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4 text-center text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"L1 â†’ L2"}),e.jsxs("p",{className:"font-bold text-blue-600",children:[((gt=J[0])==null?void 0:gt.count)>0?Math.round(((pt=J[1])==null?void 0:pt.count)/((bt=J[0])==null?void 0:bt.count)*100):0,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"L2 â†’ L3"}),e.jsxs("p",{className:"font-bold text-purple-600",children:[((ft=J[1])==null?void 0:ft.count)>0?Math.round(((vt=J[2])==null?void 0:vt.count)/((jt=J[1])==null?void 0:jt.count)*100):0,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"L3 â†’ Deal"}),e.jsxs("p",{className:"font-bold text-green-600",children:[((yt=J[2])==null?void 0:yt.count)>0?Math.round(((Nt=J[3])==null?void 0:Nt.count)/((wt=J[2])==null?void 0:wt.count)*100):0,"%"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(le,{className:"w-5 h-5 text-pink-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Performance Matrix"})]}),e.jsx(Se,{width:"100%",height:300,children:e.jsxs(Mn,{data:Is,children:[e.jsx(ys,{stroke:"#e5e7eb"}),e.jsx(_s,{dataKey:"metric",stroke:"#6b7280"}),e.jsx(ws,{stroke:"#6b7280"}),e.jsx(Ps,{name:"Performance",dataKey:"value",stroke:K.purple,fill:K.purple,fillOpacity:.6})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Top 5 Performing Clients"})]}),e.jsx(Se,{width:"100%",height:300,children:e.jsxs(Rt,{data:$s,children:[e.jsx(Ve,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Ge,{dataKey:"name",stroke:"#6b7280"}),e.jsx($e,{stroke:"#6b7280"}),e.jsx(Ie,{contentStyle:{backgroundColor:"#fff",border:"2px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(Dt,{}),e.jsx(Le,{dataKey:"deals",fill:K.success,name:"Deals",radius:[8,8,0,0]}),e.jsx(Le,{dataKey:"interviews",fill:K.info,name:"Interviews",radius:[8,8,0,0]})]})})]}),(o==null?void 0:o.summary)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(se,{className:"w-10 h-10 text-green-600"}),e.jsx("span",{className:"text-3xl font-bold text-green-700",children:o.summary.strong_accounts})]}),e.jsx("p",{className:"text-sm font-semibold text-green-700 mb-1",children:"Strong Accounts"}),e.jsx("p",{className:"text-xs text-green-600",children:"High conversion, consistent performance"}),e.jsx("div",{className:"mt-3 h-2 bg-green-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:`${o.summary.strong_accounts/o.summary.total_clients*100}%`}})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-amber-50 border-2 border-yellow-200 rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Fe,{className:"w-10 h-10 text-yellow-600"}),e.jsx("span",{className:"text-3xl font-bold text-yellow-700",children:o.summary.average_accounts})]}),e.jsx("p",{className:"text-sm font-semibold text-yellow-700 mb-1",children:"Average Accounts"}),e.jsx("p",{className:"text-xs text-yellow-600",children:"Moderate performance, needs attention"}),e.jsx("div",{className:"mt-3 h-2 bg-yellow-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-600 rounded-full",style:{width:`${o.summary.average_accounts/o.summary.total_clients*100}%`}})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-rose-50 border-2 border-red-200 rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ce,{className:"w-10 h-10 text-red-600"}),e.jsx("span",{className:"text-3xl font-bold text-red-700",children:o.summary.at_risk_accounts})]}),e.jsx("p",{className:"text-sm font-semibold text-red-700 mb-1",children:"At Risk Accounts"}),e.jsx("p",{className:"text-xs text-red-600",children:"Urgent action required"}),e.jsx("div",{className:"mt-3 h-2 bg-red-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-600 rounded-full",style:{width:`${o.summary.at_risk_accounts/o.summary.total_clients*100}%`}})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5 text-gray-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Detailed Client Analytics"})]})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left py-4 px-4 text-sm font-semibold text-gray-700",children:"Client"}),e.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-gray-700",children:"Health"}),e.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-gray-700",children:"Roles"}),e.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-gray-700",children:"Interviews"}),e.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-gray-700",children:"Deals"}),e.jsxs("th",{className:"text-center py-4 px-4 text-sm font-semibold text-gray-700",children:[e.jsx(Ya,{className:"w-4 h-4 inline mr-1"}),"Conversion"]}),e.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-gray-700",children:"Issues"}),e.jsx("th",{className:"text-center py-4 px-4 text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:O.map(n=>{const u=n.on_hold_roles+n.no_answer_roles+n.cancelled_roles+n.lost_roles;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:n.client_name}),e.jsx("p",{className:"text-xs text-gray-500 font-mono",children:n.client_code})]})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold ${n.health_tag==="Strong Account"?"bg-green-100 text-green-700":n.health_tag==="At Risk Account"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:[n.health_tag==="Strong Account"&&e.jsx(se,{className:"w-3 h-3"}),n.health_tag==="At Risk Account"&&e.jsx(Ce,{className:"w-3 h-3"}),n.health_tag==="Average Account"&&e.jsx(Fe,{className:"w-3 h-3"}),n.health_score]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-gray-900 text-lg",children:n.total_roles}),e.jsxs("p",{className:"text-xs text-green-600",children:[n.active_roles," active"]})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-gray-900 text-lg",children:n.total_interviews}),e.jsxs("div",{className:"flex gap-1 justify-center mt-1",children:[e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:["L1:",n.interview_1_count]}),e.jsxs("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded",children:["L2:",n.interview_2_count]}),e.jsxs("span",{className:"text-xs bg-pink-100 text-pink-700 px-2 py-0.5 rounded",children:["L3:",n.interview_3_count]})]})]})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-1 px-4 py-2 bg-green-100 text-green-700 rounded-full font-bold",children:[e.jsx(se,{className:"w-4 h-4"}),n.deal_roles]})}),e.jsxs("td",{className:"py-4 px-4 text-center",children:[e.jsxs("div",{className:"font-bold text-lg text-indigo-600",children:[n.roles_to_deal_conversion.toFixed(1),"%"]}),e.jsx("div",{className:"mt-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full",style:{width:`${Math.min(n.roles_to_deal_conversion,100)}%`}})})]}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`font-bold text-lg ${u>10?"text-red-600":u>5?"text-yellow-600":"text-gray-600"}`,children:u}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-0.5 mt-1",children:[n.lost_roles>0&&e.jsxs("p",{className:"text-red-600",children:["Lost: ",n.lost_roles]}),n.on_hold_roles>0&&e.jsxs("p",{className:"text-yellow-600",children:["Hold: ",n.on_hold_roles]}),n.no_answer_roles>0&&e.jsxs("p",{className:"text-orange-600",children:["No Ans: ",n.no_answer_roles]})]})]})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsxs("button",{onClick:()=>De({client_id:n.client_id,client_name:n.client_name,client_code:n.client_code,total_roles:n.total_roles,active_roles:n.active_roles,interview_1:n.interview_1_count,interview_2:n.interview_2_count,interview_3:n.interview_3_count,deals:n.deal_roles,lost:n.lost_roles,on_hold:n.on_hold_roles,no_answer:n.no_answer_roles,cancelled:n.cancelled_roles,health:n.health_tag.replace(" Account","")}),className:"px-3 py-1.5 bg-indigo-600 text-white rounded-lg text-xs font-medium hover:bg-indigo-700 transition-colors inline-flex items-center gap-1.5",children:[e.jsx(Pa,{className:"w-3.5 h-3.5"}),"View Details"]})})]},n.client_id)})})]}),O.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(oe,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No client data available for the selected filters"})]})]})]}),ce&&e.jsx(Zn,{client:ce,onClose:()=>De(null)}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 group cursor-help relative",children:[e.jsxs("h4",{className:"font-bold text-blue-900 text-lg flex items-center gap-2",children:[e.jsx(Pt,{className:"w-6 h-6"}),"Performance Insights"]}),e.jsx(Ot,{className:"w-5 h-5 text-blue-400 hover:text-blue-600 transition-colors"}),e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-96 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 left-8 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Performance Insights"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:"AI-powered analysis identifying your strongest client relationships and areas requiring attention. Use these insights to prioritize your account management activities."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200 group cursor-help relative",children:[e.jsxs("p",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Strong Points"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[q>20&&e.jsxs("li",{children:["â€¢ Excellent conversion rate (",q.toFixed(1),"%)"]}),re>10&&e.jsxs("li",{children:["â€¢ High deal volume (",re," closed deals)"]}),(o==null?void 0:o.summary.strong_accounts)>(o==null?void 0:o.summary.at_risk_accounts)&&e.jsx("li",{children:"â€¢ More strong accounts than at-risk accounts"}),ge>z*2&&e.jsx("li",{children:"â€¢ Strong interview engagement across roles"}),!q&&!re&&e.jsx("li",{children:"â€¢ Building your track record"})]}),e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Your Strengths"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:"These are areas where you excel. Continue these successful practices and share them with team members. Your strong conversion rate indicates effective role management and client communication."})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200 group cursor-help relative",children:[e.jsxs("p",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Areas for Improvement"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[q<15&&e.jsxs("li",{children:["â€¢ Focus on improving conversion rate (currently ",q.toFixed(1),"%)"]}),(o==null?void 0:o.summary.at_risk_accounts)>0&&e.jsxs("li",{children:["â€¢ Address ",o.summary.at_risk_accounts," at-risk account(s)"]}),O.some(n=>n.no_answer_roles>5)&&e.jsx("li",{children:"â€¢ Follow up with clients showing low response rates"}),O.some(n=>n.lost_roles>n.deal_roles)&&e.jsx("li",{children:"â€¢ Review processes for clients with high lost role counts"}),!q&&!re&&e.jsx("li",{children:"â€¢ Start closing deals to build momentum"})]}),e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Growth Opportunities"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:"These areas need attention to improve your overall performance. Prioritize at-risk accounts and work on improving response rates from clients to maintain healthy relationships."})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl shadow-lg border-2 border-indigo-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 group cursor-help relative",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center",children:e.jsx(va,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Recommended Corrective Actions"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Strategic initiatives to optimize client performance"})]}),e.jsx(Ot,{className:"w-5 h-5 text-gray-400 hover:text-gray-600 transition-colors ml-auto"}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 right-8 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Action Plan"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:"Prioritized recommendations based on client health, conversion rates, and role performance. Focus on high-priority actions first for maximum impact."})]})]}),e.jsx("div",{className:"space-y-4",children:(()=>{const n=[],u=O.filter(_=>_.health_tag==="At Risk Account");u.length>0&&u.slice(0,2).forEach(_=>{n.push({priority:"high",title:`Urgent: Restore ${_.client_name} Account Health`,description:`Health score: ${_.health_score}. ${_.lost_roles} lost roles, ${_.no_answer_roles} no-response roles.`,steps:[`Schedule immediate face-to-face meeting with ${_.client_name} stakeholders`,`Review all ${_.total_roles} roles - identify wins and pain points`,`Present data-driven insights: ${_.total_interviews} interviews, ${_.deal_roles} deals`,`Address ${_.no_answer_roles} unresponsive roles - get clear next steps`,"Create 30-day action plan with weekly check-ins","Consider assigning senior recruiter as dedicated point of contact"],impact:`Save ${_.client_name} relationship and prevent account loss`})}),q<15&&z>5&&n.push({priority:"high",title:"Improve Overall Conversion Rate",description:`Current rate: ${q.toFixed(1)}%. Industry target: 20-25%. Affecting all ${z} roles.`,steps:[`Analyze top ${Math.ceil(O.length*.2)} performing clients - what's working?`,"Implement weekly role pipeline review with recruitment team","Set conversion targets by client and track weekly progress","Improve candidate screening criteria before client submission","Enhance interview prep process for candidates","Speed up feedback loops between interviews"],impact:`Increase conversion from ${q.toFixed(1)}% to 20%+, adding ${Math.round((.2-q/100)*z)} more deals`});const I=O.filter(_=>_.no_answer_roles>5);I.length>0&&n.push({priority:"medium",title:"Reduce Client Non-Response Rates",description:`${I.length} client(s) have 5+ unresponsive roles. Total: ${O.reduce((_,w)=>_+w.no_answer_roles,0)} no-answer roles.`,steps:[`Priority clients: ${I.slice(0,3).map(_=>_.client_name).join(", ")}`,"Set up automated follow-up reminders for pending responses","Establish SLA expectations with clients for response times","Use multiple contact channels (email, phone, Slack/Teams)","Escalate to client executives if delays persist","Document and share unresponsive role outcomes with team"],impact:"Reduce no-answer roles by 50% and improve client engagement"});const C=O.filter(_=>_.lost_roles>_.deal_roles&&_.lost_roles>2);return C.length>0&&n.push({priority:"high",title:"Address High Role Loss Rate",description:`${C.length} client(s) losing more roles than closing. Pattern suggests process issues.`,steps:["Conduct post-mortem analysis on all lost roles","Common reasons: unrealistic requirements, poor communication, budget misalignment?","Meet with each affected client to understand root causes","Adjust role intake process - set clearer expectations upfront","Implement qualification checklist before accepting new roles","Train recruiters on spotting red flags early"],impact:"Reduce lost roles by 40% and improve role success rate"}),ge<z&&z>10&&n.push({priority:"medium",title:"Increase Interview Activity",description:`Only ${ge} interviews for ${z} roles (${(ge/z).toFixed(1)} per role). Target: 2-3 interviews per active role.`,steps:["Work with recruiters to increase submission quality and volume","Review role requirements - are they too restrictive?","Expand talent pool by considering adjacent skill sets","Speed up screening and submission processes","Set weekly submission targets per active role","Celebrate and learn from high-interview roles"],impact:`Increase to ${Math.round(z*2)} interviews, improving deal pipeline`}),n.length===0&&q>=20&&n.push({priority:"low",title:"Optimize High-Performing Account Management",description:`Excellent ${q.toFixed(1)}% conversion rate with ${re} closed deals.`,steps:["Document your successful client management playbook","Mentor other AMs - share what works","Explore expansion opportunities with strong clients","Consider taking on 1-2 strategic new accounts","Maintain current service levels while scaling","Set stretch goals: aim for 25%+ conversion rate"],impact:"Scale success across more clients and support team growth"}),n.length===0&&n.push({priority:"medium",title:"Build Consistent Performance Foundation",description:"Establish strong account management practices.",steps:["Set up weekly client check-in schedule","Create role pipeline dashboards for visibility","Establish clear communication protocols with clients","Build relationships with hiring managers at each client","Track and improve key metrics: conversion, response time, satisfaction","Regularly review and update role requirements"],impact:"Build sustainable client relationships and predictable performance"}),n.map((_,w)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-slate-200 p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase border-2 ${_.priority==="high"?"bg-red-100 text-red-700 border-red-300":_.priority==="medium"?"bg-yellow-100 text-yellow-700 border-yellow-300":"bg-blue-100 text-blue-700 border-blue-300"}`,children:[_.priority," Priority"]})}),e.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:_.title}),e.jsx("p",{className:"text-sm text-slate-600",children:_.description})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-bold text-slate-700 mb-2",children:"Action Steps:"}),e.jsx("ul",{className:"space-y-2",children:_.steps.map((_e,xe)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-indigo-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm text-slate-700",children:_e})]},xe))})]}),e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-indigo-600"}),e.jsx("span",{className:"text-sm font-semibold text-indigo-800",children:"Expected Impact:"})]}),e.jsx("p",{className:"text-sm text-indigo-700 mt-1",children:_.impact})]})]},w))})()})]}),e.jsx(ja,{isOpen:we,onClose:()=>mt(!1),teams:N,clients:f,onDownload:Os,allowedRoles:["account_manager"]})]})}function Xn(){const[t,s]=i.useState(0),[a,r]=i.useState(""),[l,d]=i.useState([]),[o,c]=i.useState(0),[m,h]=i.useState(!0),[f,v]=i.useState(null),[N,k]=i.useState(null),[g,P]=i.useState([]);i.useEffect(()=>{$()},[]),i.useEffect(()=>{const b=setInterval(()=>{$()},3e4);return()=>clearInterval(b)},[]);const $=async()=>{try{const[b,E,x,p]=await Promise.all([L("/api/am/ebes-score"),L("/api/am/client-analytics"),L("/api/am/dropout-requests"),L("/api/am/aging")]);if(b.ok){const y=await b.json();s(y.score),r(y.performance_label)}else{const y=await b.json().catch(()=>({error:b.statusText}));throw new Error(`EBES Score: ${y.error||b.statusText}`)}if(E.ok){const y=await E.json();d(y)}else{const y=await E.json().catch(()=>({error:E.statusText}));console.error("Failed to fetch clients:",y.error)}if(x.ok){const y=await x.json();c(y.length)}else{const y=await x.json().catch(()=>({error:x.statusText}));console.error("Failed to fetch dropouts:",y.error)}if(p.ok){const y=await p.json();k(y.metrics),P(y.roles)}else{const y=await p.json().catch(()=>({error:p.statusText}));console.error("Failed to fetch aging metrics:",y.error)}}catch(b){console.error("Failed to fetch dashboard data:",b),v(b instanceof Error?b.message:"Failed to load dashboard data")}finally{h(!1)}},R=b=>{switch(b){case"Strong":return"text-green-700 bg-green-100 border-green-200";case"Average":return"text-yellow-700 bg-yellow-100 border-yellow-200";case"At Risk":return"text-red-700 bg-red-100 border-red-200";default:return"text-slate-700 bg-slate-100 border-slate-200"}},j=b=>{switch(b){case"Strong":return"ðŸ’ª";case"Average":return"ðŸ˜";case"At Risk":return"âš ï¸";default:return"â“"}};return m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-indigo-200 border-t-indigo-600"})}):f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Ae,{className:"w-12 h-12 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Failed to Load Dashboard"}),e.jsx("p",{className:"text-slate-600 mb-4 text-center max-w-md",children:f}),e.jsx("button",{onClick:$,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:"Try Again"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Dashboard"}),e.jsx("p",{className:"text-slate-600",children:"Your performance overview and client health monitoring"})]}),o>0&&e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 rounded-xl shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-lg",children:e.jsx(Ae,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:"Dropout Decisions Needed"}),e.jsxs("p",{className:"text-orange-100",children:["You have ",o," pending dropout ",o===1?"request":"requests"," requiring your decision"]})]})]}),e.jsx("a",{href:"/am/dropouts",className:"px-6 py-3 bg-white text-orange-600 font-semibold rounded-lg hover:bg-orange-50 transition-colors shadow-lg",children:"Review Now"})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-xl p-8 text-white",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(le,{className:"w-6 h-6"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Your EBES Score"})]}),e.jsx("p",{className:"text-indigo-100 text-sm",children:"Employee Best Effort Score"})]}),e.jsx(fs,{type:"ebes",score:t,label:a})]}),e.jsxs("div",{className:"flex items-end gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-6xl font-bold mb-2",children:t.toFixed(1)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-4 py-1.5 bg-white/20 backdrop-blur-sm rounded-full text-sm font-medium",children:a}),e.jsx(ve,{className:"w-5 h-5"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-indigo-100 mb-1",children:"Performance Level"}),e.jsx("div",{className:"w-32 h-2 bg-white/20 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-500",style:{width:`${Math.min(t,100)}%`}})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"Client Health"]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Monitor your clients' performance and engagement"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsxs("span",{children:[l.length," ",l.length===1?"Client":"Clients"]})]})]})}),l.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Ae,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600",children:"No client data available"})]}):e.jsx("div",{className:"divide-y divide-slate-200",children:l.map(b=>e.jsxs("div",{className:"p-6 hover:bg-slate-50 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:b.name}),e.jsx("span",{className:"text-sm text-slate-500 font-mono",children:b.client_code}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${R(b.health)}`,children:[j(b.health)," ",b.health]})]})})}),e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Total Roles"}),e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:b.total_roles})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-blue-600 mb-1",children:"Active"}),e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:b.active_roles})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-purple-600 mb-1",children:"Interviews"}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:b.interviews})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-green-600 mb-1",children:"Deals"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:b.deals})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-red-600 mb-1",children:"Dropouts"}),e.jsx("div",{className:"text-2xl font-bold text-red-700",children:b.dropouts})]})]}),b.total_roles>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600 mb-2",children:[e.jsx("span",{children:"Deal Conversion"}),e.jsx("span",{children:b.total_roles>0?`${(b.deals/b.total_roles*100).toFixed(1)}%`:"0%"})]}),e.jsx("div",{className:"w-full h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-green-600 rounded-full transition-all duration-500",style:{width:`${b.total_roles>0?b.deals/b.total_roles*100:0}%`}})})]})]},b.id))})]}),N&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Role Aging & SLA"]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"How long roles are open and responsiveness metrics"})]})})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Avg Days Open"}),e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:N.avg_days_open})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-red-600 mb-1",children:"Roles â‰¥14d"}),e.jsx("div",{className:"text-2xl font-bold text-red-700",children:N.roles_over_14})]}),e.jsxs("div",{className:"bg-red-100 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-red-700 mb-1",children:"Roles â‰¥30d"}),e.jsx("div",{className:"text-2xl font-bold text-red-800",children:N.roles_over_30})]}),e.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-emerald-600 mb-1",children:"Avg Time to 1st Submission (days)"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:N.avg_time_to_first_submission})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-indigo-600 mb-1",children:"Avg Time to 1st Interview (days)"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-700",children:N.avg_time_to_first_interview})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"Role"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"Days Open"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"1st Submission"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"1st Interview"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:g.slice(0,8).map(b=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:b.title}),e.jsx("span",{className:"text-xs text-slate-500 font-mono",children:b.role_code}),b.has_dropout&&e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-semibold rounded border border-red-200",children:"Dropped Out"})]})}),e.jsx("td",{className:"px-4 py-2 text-slate-800 font-medium",children:b.days_open}),e.jsx("td",{className:"px-4 py-2 text-slate-700",children:b.first_submission_days??"â€”"}),e.jsx("td",{className:"px-4 py-2 text-slate-700",children:b.first_interview_days??"â€”"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold border",children:b.status})})]},b.id))})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(le,{className:"w-5 h-5 text-blue-600"})}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Roles"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800",children:l.reduce((b,E)=>b+E.total_roles,0)})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(ve,{className:"w-5 h-5 text-green-600"})}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Deals"})]}),e.jsx("div",{className:"text-3xl font-bold text-green-700",children:l.reduce((b,E)=>b+E.deals,0)})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(G,{className:"w-5 h-5 text-purple-600"})}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Interviews"})]}),e.jsx("div",{className:"text-3xl font-bold text-purple-700",children:l.reduce((b,E)=>b+E.interviews,0)})]})]})]})}function Qn(){const{user:t}=ts(),[s,a]=i.useState([]),[r,l]=i.useState([]),[d,o]=i.useState(!0);i.useEffect(()=>{c()},[]);const c=async()=>{try{const m=await L("/api/am/assignments");if(m.ok){const h=await m.json();a(h.clients),l(h.teams)}}catch(m){console.error("Failed to fetch assignments:",m)}finally{o(!1)}};return d?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Profile"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Your account information and assignments"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-2xl p-8 text-white",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-24 h-24 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:e.jsx(bs,{className:"w-16 h-16 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-3xl font-bold mb-2",children:t==null?void 0:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-white/80 mb-1",children:[e.jsx(Fs,{className:"w-4 h-4"}),e.jsx("span",{children:t==null?void 0:t.email})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white/80",children:[e.jsx(st,{className:"w-4 h-4"}),e.jsx("span",{className:"font-mono",children:t==null?void 0:t.user_code})]})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-white/20",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:[e.jsx("p",{className:"text-white/80 text-sm mb-1",children:"Role"}),e.jsx("p",{className:"text-xl font-bold",children:"Account Manager"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:[e.jsx("p",{className:"text-white/80 text-sm mb-1",children:"Status"}),e.jsx("p",{className:"text-xl font-bold",children:"Active"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(oe,{className:"w-6 h-6 text-indigo-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Assigned Clients"})]}),e.jsx("div",{className:"space-y-3",children:s.length>0?s.map(m=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:m.name}),e.jsx("p",{className:"text-xs text-gray-500 font-mono",children:m.client_code})]})},m.id)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No clients assigned"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(G,{className:"w-6 h-6 text-indigo-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Assigned Teams"})]}),e.jsx("div",{className:"space-y-3",children:r.length>0?r.map(m=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:m.name}),e.jsx("p",{className:"text-xs text-gray-500 font-mono",children:m.team_code})]})},m.id)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No teams assigned"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(it,{className:"w-6 h-6 text-gray-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Account Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"User ID"}),e.jsx("p",{className:"font-semibold text-gray-900",children:t==null?void 0:t.id})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"User Code"}),e.jsx("p",{className:"font-mono font-semibold text-gray-900",children:t==null?void 0:t.user_code})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Clients Managed"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.length})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Teams Managed"}),e.jsx("p",{className:"font-semibold text-gray-900",children:r.length})]})]})]})]})}function el({onConfirm:t,onSkip:s}){const a=new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 animate-scale-in",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"p-4 bg-indigo-100 rounded-full",children:e.jsx(it,{className:"w-8 h-8 text-indigo-600"})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 text-center mb-3",children:"Monthly Data Update"}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Ae,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-900 mb-1",children:"Is the previous month's data updated?"}),e.jsxs("p",{className:"text-sm text-yellow-700",children:["Please ensure all interview counts and role statuses are up to date for"," ",a]})]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:s,className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Skip"}),e.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Yes, Updated"})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"If you skip, this reminder will appear again at your next login"})]})})}function tl(){const[t,s]=i.useState([]),[a,r]=i.useState(!0),[l,d]=i.useState(null),[o,c]=i.useState(null),[m,h]=i.useState(""),[f,v]=i.useState(!1);i.useEffect(()=>{N()},[]);const N=async()=>{try{const g=await L("/api/am/dropout-requests");if(g.ok){const P=await g.json();s(P)}}catch(g){console.error("Failed to fetch dropout requests:",g)}finally{r(!1)}},k=async()=>{if(!(!l||!o)){if(o==="accept"&&!m){alert("Please select a role status for accepted dropouts");return}v(!0);try{(await L(`/api/am/dropout-requests/${l.id}/decide`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({decision:o,new_role_status:m||null})})).ok?(s(P=>P.filter($=>$.id!==l.id)),d(null),c(null),h("")):alert("Failed to process decision")}catch(g){console.error("Failed to decide:",g),alert("Failed to process decision")}finally{v(!1)}}};return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-indigo-200 border-t-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dropout Decisions"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-100 rounded-lg",children:[e.jsx(Ce,{className:"w-5 h-5 text-red-600"}),e.jsxs("span",{className:"text-sm font-medium text-red-800",children:[t.length," Awaiting Decision"]})]})]}),t.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:[e.jsx(se,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"No Pending Decisions"}),e.jsx("p",{className:"text-slate-600",children:"All dropout requests have been processed."})]}):e.jsx("div",{className:"grid gap-4",children:t.map(g=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:"Dropout - Decision Required"}),e.jsxs("span",{className:"text-sm text-slate-500",children:["RM Acknowledged: ",new Date(g.rm_acknowledged_at).toLocaleDateString()]})]}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-1",children:g.role_title}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Role Code:"}),e.jsx("span",{className:"ml-2 font-medium text-slate-800",children:g.role_code})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Client:"}),e.jsx("span",{className:"ml-2 font-medium text-slate-800",children:g.client_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Recruiter:"}),e.jsxs("span",{className:"ml-2 font-medium text-slate-800",children:[g.recruiter_name," (",g.recruiter_code,")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"RM:"}),e.jsx("span",{className:"ml-2 font-medium text-slate-800",children:g.rm_name||"N/A"})]})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Et,{className:"w-4 h-4 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-orange-800 block mb-1",children:"Recruiter's Reason:"}),e.jsx("p",{className:"text-sm text-orange-700",children:g.dropout_reason})]})]})}),g.rm_notes&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Et,{className:"w-4 h-4 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-blue-800 block mb-1",children:"RM's Notes:"}),e.jsx("p",{className:"text-sm text-blue-700",children:g.rm_notes})]})]})})]})]})}),e.jsx("button",{onClick:()=>d(g),className:"w-full mt-4 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:"Make Decision"})]},g.id))}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Dropout Decision"})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"Request Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Role:"}),e.jsx("span",{className:"font-medium text-slate-800",children:l.role_title})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Code:"}),e.jsx("span",{className:"font-medium text-slate-800",children:l.role_code})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Recruiter:"}),e.jsxs("span",{className:"font-medium text-slate-800",children:[l.recruiter_name," (",l.recruiter_code,")"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-orange-800 mb-2",children:"Recruiter's Reason:"}),e.jsx("p",{className:"text-sm text-orange-700",children:l.dropout_reason})]}),l.rm_notes&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"RM's Notes:"}),e.jsx("p",{className:"text-sm text-blue-700",children:l.rm_notes})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:"Your Decision:"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx("button",{onClick:()=>c("accept"),className:`p-4 border-2 rounded-lg text-left transition-all ${o==="accept"?"border-red-500 bg-red-50":"border-slate-200 hover:border-red-300"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(at,{className:`w-6 h-6 ${o==="accept"?"text-red-600":"text-slate-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold text-slate-800 mb-1",children:"Accept Dropout"}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Recruiter is at fault. Apply ",e.jsx("strong",{children:"-5 points"})," penalty to their EBES score."]})]})]})}),e.jsx("button",{onClick:()=>c("ignore"),className:`p-4 border-2 rounded-lg text-left transition-all ${o==="ignore"?"border-green-500 bg-green-50":"border-slate-200 hover:border-green-300"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(se,{className:`w-6 h-6 ${o==="ignore"?"text-green-600":"text-slate-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold text-slate-800 mb-1",children:"Ignore Dropout"}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Not recruiter's fault. ",e.jsx("strong",{children:"No penalty"})," applied. Can optionally update role status."]})]})]})})]}),o&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:o==="accept"?e.jsxs(e.Fragment,{children:["Update Role Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}):e.jsx(e.Fragment,{children:"Update Role Status (Optional)"})}),e.jsxs("select",{value:m,onChange:g=>h(g.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Choose status..."}),e.jsx("option",{value:"dropout",children:"Dropout"}),e.jsx("option",{value:"lost",children:"Lost"}),e.jsx("option",{value:"on_hold",children:"On Hold"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"no_answer",children:"No Answer"})]}),o==="accept"&&e.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:[e.jsx("strong",{children:"Note:"})," Selecting any status will apply -5 penalty to recruiter's EBES score."]}),o==="ignore"&&e.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:[e.jsx("strong",{children:"Note:"}),' Even if you set status to "Dropout", no penalty will be applied.']})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 flex gap-3",children:[e.jsx("button",{onClick:()=>{d(null),c(null),h("")},disabled:f,className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:k,disabled:f||!o,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Processing..."]}):"Confirm Decision"})]})]})})]})}function sl({clients:t,teams:s,selectedClient:a,selectedTeam:r,onSelectClient:l,onSelectTeam:d}){const o=t.length>1&&!a,c=s.length>1&&!r;return e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Select Your Assignment"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Please select a client and team to continue managing roles"}),e.jsxs("div",{className:"space-y-8",children:[o&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5 text-green-600"}),"Select Client"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(m=>e.jsxs("button",{onClick:()=>l(m),className:"p-4 border-2 border-gray-200 rounded-xl hover:border-green-500 hover:bg-green-50 transition-all text-left group",children:[e.jsx("p",{className:"font-semibold text-gray-900 group-hover:text-green-700",children:m.name}),e.jsx("p",{className:"text-sm text-gray-600 font-mono mt-1",children:m.client_code})]},m.id))})]}),!o&&a&&e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-xl",children:[e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Selected Client:"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:a.name})]}),c&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-blue-600"}),"Select Team"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(m=>e.jsxs("button",{onClick:()=>d(m),className:"p-4 border-2 border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-all text-left group",children:[e.jsx("p",{className:"font-semibold text-gray-900 group-hover:text-blue-700",children:m.name}),e.jsx("p",{className:"text-sm text-gray-600 font-mono mt-1",children:m.team_code})]},m.id))})]}),!c&&r&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Selected Team:"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:r.name})]})]})]})})}function hl(){const[t,s]=i.useState([]),[a,r]=i.useState([]),[l,d]=i.useState(null),[o,c]=i.useState(null),[m,h]=i.useState(!0),[f,v]=i.useState(!1);i.useEffect(()=>{N(),k()},[]);const N=async()=>{try{const R=await L("/api/am/assignments");if(R.ok){const j=await R.json();s(j.clients),r(j.teams),j.clients.length===1&&d(j.clients[0]),j.teams.length===1&&c(j.teams[0])}}catch(R){console.error("Failed to fetch assignments:",R)}finally{h(!1)}},k=async()=>{try{const R=await L("/api/am/reminder-status");if(R.ok){const j=await R.json();v(j.shouldShow)}}catch(R){console.error("Failed to check reminder status:",R)}},g=async()=>{try{(await L("/api/am/confirm-reminder",{method:"POST"})).ok&&v(!1)}catch(R){console.error("Failed to confirm reminder:",R)}},P=()=>{v(!1)},$=t.length>1&&!l||a.length>1&&!o;return m?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):t.length===0||a.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center space-y-4",children:[e.jsx("div",{className:"text-yellow-500 text-5xl",children:"âš ï¸"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"No Assignments"}),e.jsx("p",{className:"text-gray-600",children:"You have not been assigned any clients or teams yet. Please contact your administrator."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(zn,{selectedClient:l,selectedTeam:o,onChangeClient:()=>d(null),onChangeTeam:()=>c(null),showChangeButtons:t.length>1||a.length>1,children:$?e.jsx(sl,{clients:t,teams:a,selectedClient:l,selectedTeam:o,onSelectClient:d,onSelectTeam:c}):e.jsxs(Bs,{children:[e.jsx(me,{path:"/",element:e.jsx(Xn,{})}),e.jsx(me,{path:"/roles",element:e.jsx(Gn,{clientId:l.id,teamId:o.id})}),e.jsx(me,{path:"/analytics",element:e.jsx(Jn,{})}),e.jsx(me,{path:"/dropouts",element:e.jsx(tl,{})}),e.jsx(me,{path:"/company",element:e.jsx(ya,{})}),e.jsx(me,{path:"/profile",element:e.jsx(Qn,{})}),e.jsx(me,{path:"*",element:e.jsx(zs,{to:"/am",replace:!0})})]})}),f&&e.jsx(el,{onConfirm:g,onSkip:P})]})}export{hl as default};
