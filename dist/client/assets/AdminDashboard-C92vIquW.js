import{c as ce,u as Ve,a as Xe,r as l,j as e,L as Ye,C as Ke,T as ge,R as Qe,b as ee,N as Ze}from"./index-C7EJkjUr.js";import{U as pe,C as de,N as es,T as Me,a as ss,F as Pe,b as _e,R as ts,D as as,A as ve,c as Le,d as rs,e as ls,f as we,g as Ie,h as Se,B as ns,i as is,X as os,Y as ds,j as cs,k as ms,l as Ue,L as xs,m as hs,n as gs}from"./CompanyPage-bcY5Um_O.js";import{f as S}from"./api-D8SveD0E.js";import{U as ne}from"./users-C13lqfXm.js";import{B as ue}from"./building-2-Cuz0WzKd.js";import{L as ps}from"./log-out-D2TEcKqa.js";import{X as ie,T as se,P as te,S as Ce}from"./x-yUVYYHrF.js";import{S as be}from"./search-CUq3Q4fS.js";import{P as $e,a as Fe}from"./PieChart-Uib3cxLe.js";import"./briefcase-DAyzHxKh.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],bs=ce("chevron-down",us);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],js=ce("chevron-up",fs);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ns=ce("info",ys);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],ws=ce("medal",vs);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Oe=ce("settings",Ss);function _s({children:a}){const R=Ve(),{user:o,logout:h}=Xe(),[j,v]=l.useState(!0);l.useEffect(()=>{y()},[]);const y=async()=>{try{const x=await S("/api/company/settings");if(x.ok){const _=await x.json();v(_.show_company_page)}}catch(x){console.error("Failed to fetch company settings:",x)}},f=[{path:"/admin/users",label:"Users",icon:ne},{path:"/admin/clients",label:"Clients",icon:ue},{path:"/admin/teams",label:"Teams",icon:pe},{path:"/admin/performance",label:"Performance",icon:de},{path:"/admin/settings",label:"Settings",icon:Oe}];return j&&f.splice(4,0,{path:"/admin/company",label:"Company",icon:Me}),e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"w-64 bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-700",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"EBES Admin"}),e.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Dashboard"})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:f.map(x=>{const _=x.icon,m=R.pathname===x.path;return e.jsxs(Ye,{to:x.path,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${m?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[e.jsx(_,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:x.label})]},x.path)})}),e.jsxs("div",{className:"p-4 border-t border-slate-700",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-white font-medium text-sm",children:o==null?void 0:o.name}),e.jsx("p",{className:"text-slate-400 text-xs",children:o==null?void 0:o.email}),e.jsx("p",{className:"text-indigo-400 text-xs mt-1 font-mono",children:o==null?void 0:o.user_code})]}),e.jsxs("button",{onClick:h,className:"w-full flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(ps,{className:"w-4 h-4"}),"Logout"]})]})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-8 py-4 flex items-center justify-end shadow-sm",children:e.jsx(es,{})}),e.jsx("div",{className:"max-w-7xl mx-auto p-8",children:a})]})]})}function Cs({onClose:a,onUserCreated:R}){const[o,h]=l.useState({name:"",email:"",role:"recruiter",password:""}),[j,v]=l.useState(!1),[y,f]=l.useState(null),[x,_]=l.useState(null),m=async N=>{N.preventDefault(),v(!0),f(null);try{const p=await S("/api/admin/users",{method:"POST",body:JSON.stringify(o)});if(p.ok){const k=await p.json();_(k.user_code),setTimeout(()=>{R()},2e3)}else{const k=await p.json();f(k.error||"Failed to create user")}}catch{f("An error occurred while creating the user")}finally{v(!1)}};return x?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 text-center space-y-4",children:[e.jsx("div",{className:"text-green-500 text-5xl",children:"✓"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"User Created Successfully!"}),e.jsxs("div",{className:"bg-indigo-50 border-2 border-indigo-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"User Code"}),e.jsx("p",{className:"text-3xl font-bold text-indigo-600 font-mono",children:x})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"The user has been created and can now log in with their Google account."})]})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Add New User"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ie,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:N=>h({...o,name:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:o.email,onChange:N=>h({...o,email:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:o.role,onChange:N=>h({...o,role:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"recruiter",children:"Recruiter"}),e.jsx("option",{value:"recruitment_manager",children:"Recruitment Manager"}),e.jsx("option",{value:"account_manager",children:"Account Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:o.password,onChange:N=>h({...o,password:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",minLength:6,required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters"})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:y}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:j,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:j?"Creating...":"Create User"})]})]})]})})}function Rs({user:a,onClose:R,onUserUpdated:o}){const[h,j]=l.useState({name:a.name,role:a.role,password:"",is_active:a.is_active}),[v,y]=l.useState(!1),[f,x]=l.useState(null),_=async m=>{var N,p;m.preventDefault(),y(!0),x(null);try{const k={name:h.name,role:h.role,is_active:h.is_active};h.password.trim()&&(k.password=h.password);const E=await S(`/api/admin/users/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});if(E.ok)o(),R();else{const $=await E.json();E.status===401||E.status===403?x("Session expired. Please log out and log back in."):x($.error||"Failed to update user")}}catch(k){console.error("Update user error:",k),(N=k.message)!=null&&N.includes("session")||(p=k.message)!=null&&p.includes("authenticated")?x("Session expired. Please log out and log back in."):x("An error occurred while updating the user. Please try again.")}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Edit User"}),e.jsx("button",{onClick:R,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ie,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"User Code"}),e.jsx("p",{className:"font-mono font-bold text-gray-900",children:a.user_code})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:a.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:h.name,onChange:m=>j({...h,name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:h.role,onChange:m=>j({...h,role:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"recruiter",children:"Recruiter"}),e.jsx("option",{value:"recruitment_manager",children:"Recruitment Manager"}),e.jsx("option",{value:"account_manager",children:"Account Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password (leave blank to keep current)"}),e.jsx("input",{type:"password",value:h.password,onChange:m=>j({...h,password:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",minLength:6})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:h.is_active,onChange:m=>j({...h,is_active:m.target.checked}),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"Active"})]}),f&&e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 text-red-800 px-4 py-3 rounded-lg flex items-start gap-3",children:[e.jsx(Ke,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:f}),f.includes("Session expired")&&e.jsx("button",{type:"button",onClick:()=>{localStorage.clear(),window.location.href="/login"},className:"mt-2 text-sm underline hover:no-underline",children:"Go to login page"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:R,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:v?"Updating...":"Update User"})]})]})]})})}function ks({user:a,onClose:R}){var le;const[o,h]=l.useState({teams:[],clients:[]}),[j,v]=l.useState([]),[y,f]=l.useState([]),[x,_]=l.useState(!0),[m,N]=l.useState(null),[p,k]=l.useState(null);l.useEffect(()=>{E()},[a.id]);const E=async()=>{try{const[r,b,V]=await Promise.all([S(`/api/admin/users/${a.id}/assignments`),S("/api/admin/teams"),S("/api/admin/clients")]);if(r.ok&&b.ok&&V.ok){const fe=await r.json(),me=await b.json(),je=await V.json();h(fe),v(me),f(je)}}catch(r){console.error("Failed to fetch data:",r)}finally{_(!1)}},$=async r=>{try{(await S("/api/admin/assign-team",{method:"POST",body:JSON.stringify({user_id:a.id,team_id:r})})).ok&&E()}catch(b){console.error("Failed to assign team:",b)}},L=async r=>{try{(await S("/api/admin/assign-client",{method:"POST",body:JSON.stringify({user_id:a.id,client_id:r})})).ok&&E()}catch(b){console.error("Failed to assign client:",b)}},Y=async r=>{try{(await S("/api/admin/unassign-team",{method:"DELETE",body:JSON.stringify({user_id:a.id,team_id:r})})).ok&&E()}catch(b){console.error("Failed to unassign team:",b)}},H=async r=>{try{(await S("/api/admin/unassign-client",{method:"DELETE",body:JSON.stringify({user_id:a.id,client_id:r})})).ok&&E()}catch(b){console.error("Failed to unassign client:",b)}},J=async r=>{try{const b=await S("/api/admin/assign-recruiter-team",{method:"POST",body:JSON.stringify({recruiter_user_id:a.id,team_id:r})});if(b.ok)(await b.json()).auto_assigned_client&&alert("Recruiter assigned to team and automatically assigned to the only available client!"),E();else{const V=await b.json();alert(V.error||"Failed to assign team")}}catch(b){console.error("Failed to assign team:",b)}},D=async r=>{try{(await S(`/api/admin/recruiter-team/${a.id}/${r}`,{method:"DELETE"})).ok&&E()}catch(b){console.error("Failed to unassign team:",b)}},n=async()=>{if(!m||!p){alert("Please select both team and client");return}try{const r=await S("/api/admin/assign-recruiter-client",{method:"POST",body:JSON.stringify({recruiter_user_id:a.id,client_id:p,team_id:m})});if(r.ok)N(null),k(null),E();else{const b=await r.json();alert(b.error||"Failed to assign client")}}catch(r){console.error("Failed to assign client:",r)}},w=async(r,b)=>{try{(await S(`/api/admin/recruiter-client/${r}/${b}`,{method:"DELETE"})).ok&&E()}catch(V){console.error("Failed to unassign client:",V)}},i=j.filter(r=>!o.teams.find(b=>b.id===r.id)),F=y.filter(r=>!o.clients.find(b=>b.id===r.id)),ae=a.role==="recruitment_manager"||a.role==="account_manager",Z=a.role==="account_manager"||a.role==="recruitment_manager",re=a.role==="recruiter",W=re&&o.recruiter_clients?Array.from(new Set(o.recruiter_clients.map(r=>r.team_id))).map(r=>{const b=o.recruiter_clients.find(V=>V.team_id===r);return{id:b.team_id,name:b.team_name,team_code:b.team_code}}):[],oe=re?j.filter(r=>!W.find(b=>b.id===r.id)):[];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Manage Assignments"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[a.name," (",a.user_code,")"]})]}),e.jsx("button",{onClick:R,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ie,{className:"w-6 h-6"})})]}),x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[ae&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Team Assignments"}),e.jsxs("div",{className:"space-y-2",children:[o.teams.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono",children:r.team_code})]}),e.jsx("button",{onClick:()=>Y(r.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Unassign team",children:e.jsx(se,{className:"w-4 h-4"})})]},r.id)),i.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Assign new team:"}),e.jsx("div",{className:"space-y-2",children:i.map(r=>e.jsxs("button",{onClick:()=>$(r.id),className:"w-full flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono",children:r.team_code})]}),e.jsx(te,{className:"w-4 h-4 text-indigo-600"})]},r.id))})]}),o.teams.length===0&&i.length===0&&e.jsx("p",{className:"text-gray-500 text-sm",children:"No teams available"})]})]}),Z&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Client Assignments"}),e.jsxs("div",{className:"space-y-2",children:[o.clients.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono",children:r.client_code})]}),e.jsx("button",{onClick:()=>H(r.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Unassign client",children:e.jsx(se,{className:"w-4 h-4"})})]},r.id)),F.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Assign new client:"}),e.jsx("div",{className:"space-y-2",children:F.map(r=>e.jsxs("button",{onClick:()=>L(r.id),className:"w-full flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono",children:r.client_code})]}),e.jsx(te,{className:"w-4 h-4 text-indigo-600"})]},r.id))})]}),o.clients.length===0&&F.length===0&&e.jsx("p",{className:"text-gray-500 text-sm",children:"No clients available"})]})]}),re&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Team Assignments"}),e.jsxs("div",{className:"space-y-2",children:[W.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono",children:r.team_code})]}),e.jsx("button",{onClick:()=>D(r.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Unassign team",children:e.jsx(se,{className:"w-4 h-4"})})]},r.id)),oe.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Assign new team:"}),e.jsx("div",{className:"space-y-2",children:oe.map(r=>e.jsxs("button",{onClick:()=>J(r.id),className:"w-full flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono",children:r.team_code})]}),e.jsx(te,{className:"w-4 h-4 text-indigo-600"})]},r.id))})]}),W.length===0&&oe.length===0&&e.jsx("p",{className:"text-gray-500 text-sm",children:"No teams available"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Client-Team Assignments"}),e.jsxs("div",{className:"space-y-2",children:[(le=o.recruiter_clients)==null?void 0:le.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[r.client_name," - ",r.team_name]}),e.jsxs("p",{className:"text-xs text-gray-600 font-mono",children:[r.client_code," • ",r.team_code]})]}),e.jsx("button",{onClick:()=>w(a.id,r.client_id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Unassign client",children:e.jsx(se,{className:"w-4 h-4"})})]},r.id)),W.length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Assign new client-team pair:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Select Team"}),e.jsxs("select",{value:m||"",onChange:r=>N(r.target.value?parseInt(r.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",children:[e.jsx("option",{value:"",children:"Choose a team..."}),W.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.team_code,")"]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Select Client"}),e.jsxs("select",{value:p||"",onChange:r=>k(r.target.value?parseInt(r.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",children:[e.jsx("option",{value:"",children:"Choose a client..."}),y.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.client_code,")"]},r.id))]})]}),e.jsxs("button",{onClick:n,disabled:!m||!p,className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:[e.jsx(te,{className:"w-4 h-4 inline mr-1"}),"Assign Client"]})]})]}),(!o.recruiter_clients||o.recruiter_clients.length===0)&&e.jsx("p",{className:"text-gray-500 text-sm",children:W.length===0?"Assign a team first to add client assignments":"No client assignments yet"})]})]})]}),!ae&&!Z&&!re&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"This role does not have team or client assignments."})]})]})})}function Re({title:a,message:R,onClose:o,onConfirm:h}){const[j,v]=l.useState(!1),[y,f]=l.useState(null),x=async()=>{v(!0),f(null);try{await h(),o()}catch{f("Failed to delete. Please try again.")}finally{v(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(ss,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:a})]}),e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ie,{className:"w-6 h-6"})})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:R}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:y}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:x,disabled:j,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:j?"Deleting...":"Delete"})]})]})})}function Ts(){const[a,R]=l.useState([]),[o,h]=l.useState(!0),[j,v]=l.useState(!1),[y,f]=l.useState(null),[x,_]=l.useState(null),[m,N]=l.useState(null),[p,k]=l.useState(""),[E,$]=l.useState("all");l.useEffect(()=>{L()},[]);const L=async()=>{try{const i=await S("/api/admin/users");if(i.ok){const F=await i.json();R(F)}}catch(i){console.error("Failed to fetch users:",i)}finally{h(!1)}},Y=()=>{L(),v(!1)},H=()=>{L(),f(null)},J=async()=>{if(m)try{const i=await S(`/api/admin/users/${m.id}`,{method:"DELETE"});if(i.ok)L(),N(null);else{const F=await i.json();alert(F.error||"Failed to delete user")}}catch(i){console.error("Failed to delete user:",i),alert("Failed to delete user")}},D=i=>{switch(i){case"admin":return"bg-purple-100 text-purple-700";case"recruitment_manager":return"bg-blue-100 text-blue-700";case"account_manager":return"bg-green-100 text-green-700";case"recruiter":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}},n=i=>{switch(i){case"recruitment_manager":return"Recruitment Manager";case"account_manager":return"Account Manager";default:return i.charAt(0).toUpperCase()+i.slice(1)}},w=a.filter(i=>{const F=i.name.toLowerCase().includes(p.toLowerCase())||i.email.toLowerCase().includes(p.toLowerCase())||i.user_code.toLowerCase().includes(p.toLowerCase()),ae=E==="all"||i.role===E;return F&&ae});return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Users Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage user accounts and permissions"})]}),e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[e.jsx(te,{className:"w-4 h-4"}),"Add User"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, email, or code...",value:p,onChange:i=>k(i.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsxs("select",{value:E,onChange:i=>$(i.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"recruitment_manager",children:"Recruitment Manager"}),e.jsx("option",{value:"account_manager",children:"Account Manager"}),e.jsx("option",{value:"recruiter",children:"Recruiter"})]})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Code"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:w.map(i=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-sm font-medium text-gray-900",children:i.user_code})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:i.name})]})}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:i.email}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${D(i.role)}`,children:n(i.role)})}),e.jsx("td",{className:"py-3 px-4",children:i.is_active?e.jsx("span",{className:"text-green-600 text-sm",children:"Active"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Inactive"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>f(i),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit user",children:e.jsx(Ce,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>N(i),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete user",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_(i),className:"text-indigo-600 hover:text-indigo-700 text-sm font-medium ml-2",children:"Assignments"})]})})]},i.id))})]}),w.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_e,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No users found"})]})]})]}),j&&e.jsx(Cs,{onClose:()=>v(!1),onUserCreated:Y}),y&&e.jsx(Rs,{user:y,onClose:()=>f(null),onUserUpdated:H}),x&&e.jsx(ks,{user:x,onClose:()=>_(null)}),m&&e.jsx(Re,{title:"Delete User",message:`Are you sure you want to delete ${m.name}? This action cannot be undone and will remove all associated assignments.`,onClose:()=>N(null),onConfirm:J})]})}function Es({client:a,onClose:R,onClientUpdated:o}){const[h,j]=l.useState({name:a.name,short_name:a.short_name,is_active:a.is_active}),[v,y]=l.useState(!1),[f,x]=l.useState(null),_=async m=>{m.preventDefault(),y(!0),x(null);try{const N=await S(`/api/admin/clients/${a.id}`,{method:"PUT",body:JSON.stringify(h)});if(N.ok)o(),R();else{const p=await N.json();x(p.error||"Failed to update client")}}catch{x("An error occurred while updating the client")}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Edit Client"}),e.jsx("button",{onClick:R,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ie,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Client Code"}),e.jsx("p",{className:"font-mono font-bold text-gray-900",children:a.client_code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),e.jsx("input",{type:"text",value:h.name,onChange:m=>j({...h,name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Short Name"}),e.jsx("input",{type:"text",value:h.short_name,onChange:m=>j({...h,short_name:m.target.value.slice(0,10)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",maxLength:10,required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:h.is_active,onChange:m=>j({...h,is_active:m.target.checked}),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"Active"})]}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:f}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:R,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:v?"Updating...":"Update Client"})]})]})]})})}function As(){const[a,R]=l.useState([]),[o,h]=l.useState(!0),[j,v]=l.useState(!1),[y,f]=l.useState(null),[x,_]=l.useState(null),[m,N]=l.useState(""),[p,k]=l.useState({name:"",short_name:""}),[E,$]=l.useState(null);l.useEffect(()=>{L()},[]);const L=async()=>{try{const n=await S("/api/admin/clients");if(n.ok){const w=await n.json();R(w)}}catch(n){console.error("Failed to fetch clients:",n)}finally{h(!1)}},Y=async n=>{n.preventDefault();try{const w=await S("/api/admin/clients",{method:"POST",body:JSON.stringify(p)});if(w.ok){const i=await w.json();$(i.client_code),setTimeout(()=>{L(),v(!1),k({name:"",short_name:""}),$(null)},2e3)}}catch(w){console.error("Failed to create client:",w)}},H=()=>{L(),f(null)},J=async()=>{if(!x)return;if((await S(`/api/admin/clients/${x.id}`,{method:"DELETE"})).ok)L(),_(null);else throw new Error("Failed to delete client")},D=a.filter(n=>n.name.toLowerCase().includes(m.toLowerCase())||n.client_code.toLowerCase().includes(m.toLowerCase()));return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Clients Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage client organizations"})]}),e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[e.jsx(te,{className:"w-4 h-4"}),"Add Client"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients...",value:m,onChange:n=>N(n.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.map(n=>e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(ue,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:n.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono mt-1",children:n.client_code}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Short: ",n.short_name]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>f(n),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit client",children:e.jsx(Ce,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_(n),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete client",children:e.jsx(se,{className:"w-4 h-4"})})]})]})},n.id))}),D.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No clients found"})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:E?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-green-500 text-5xl",children:"✓"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Client Created!"}),e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Client Code"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 font-mono",children:E})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Add New Client"}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),e.jsx("input",{type:"text",value:p.name,onChange:n=>k({...p,name:n.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Short Name (max 10 characters)"}),e.jsx("input",{type:"text",value:p.short_name,onChange:n=>k({...p,short_name:n.target.value.slice(0,10)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",maxLength:10,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Used in client code: CL-",p.short_name.toUpperCase()||"XXX","-001"]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{v(!1),k({name:"",short_name:""})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Create Client"})]})]})]})})}),y&&e.jsx(Es,{client:y,onClose:()=>f(null),onClientUpdated:H}),x&&e.jsx(Re,{title:"Delete Client",message:`Are you sure you want to delete ${x.name}? This action cannot be undone.`,onClose:()=>_(null),onConfirm:J})]})}function Ds({team:a,onClose:R,onTeamUpdated:o}){const[h,j]=l.useState({name:a.name,is_active:a.is_active}),[v,y]=l.useState(!1),[f,x]=l.useState(null),_=async m=>{m.preventDefault(),y(!0),x(null);try{const N=await S(`/api/admin/teams/${a.id}`,{method:"PUT",body:JSON.stringify(h)});if(N.ok)o(),R();else{const p=await N.json();x(p.error||"Failed to update team")}}catch{x("An error occurred while updating the team")}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Edit Team"}),e.jsx("button",{onClick:R,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ie,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Team Code"}),e.jsx("p",{className:"font-mono font-bold text-gray-900",children:a.team_code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Team Name"}),e.jsx("input",{type:"text",value:h.name,onChange:m=>j({...h,name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:h.is_active,onChange:m=>j({...h,is_active:m.target.checked}),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"Active"})]}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:f}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:R,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:v?"Updating...":"Update Team"})]})]})]})})}function Ls(){const[a,R]=l.useState([]),[o,h]=l.useState(!0),[j,v]=l.useState(!1),[y,f]=l.useState(null),[x,_]=l.useState(null),[m,N]=l.useState(""),[p,k]=l.useState({name:""}),[E,$]=l.useState(null);l.useEffect(()=>{L()},[]);const L=async()=>{try{const n=await S("/api/admin/teams");if(n.ok){const w=await n.json();R(w)}}catch(n){console.error("Failed to fetch teams:",n)}finally{h(!1)}},Y=async n=>{n.preventDefault();try{const w=await S("/api/admin/teams",{method:"POST",body:JSON.stringify(p)});if(w.ok){const i=await w.json();$(i.team_code),setTimeout(()=>{L(),v(!1),k({name:""}),$(null)},2e3)}}catch(w){console.error("Failed to create team:",w)}},H=()=>{L(),f(null)},J=async()=>{if(!x)return;if((await S(`/api/admin/teams/${x.id}`,{method:"DELETE"})).ok)L(),_(null);else throw new Error("Failed to delete team")},D=a.filter(n=>n.name.toLowerCase().includes(m.toLowerCase())||n.team_code.toLowerCase().includes(m.toLowerCase()));return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Teams Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage recruitment teams"})]}),e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm",children:[e.jsx(te,{className:"w-4 h-4"}),"Add Team"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search teams...",value:m,onChange:n=>N(n.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.map(n=>e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(pe,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:n.name}),e.jsx("p",{className:"text-xs text-gray-600 font-mono mt-1",children:n.team_code})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>f(n),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit team",children:e.jsx(Ce,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_(n),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete team",children:e.jsx(se,{className:"w-4 h-4"})})]})]})},n.id))}),D.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pe,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No teams found"})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:E?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-green-500 text-5xl",children:"✓"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Team Created!"}),e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Team Code"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 font-mono",children:E})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Add New Team"}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Team Name"}),e.jsx("input",{type:"text",value:p.name,onChange:n=>k({...p,name:n.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{v(!1),k({name:""})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Create Team"})]})]})]})})}),y&&e.jsx(Ds,{team:y,onClose:()=>f(null),onTeamUpdated:H}),x&&e.jsx(Re,{title:"Delete Team",message:`Are you sure you want to delete ${x.name}? This action cannot be undone.`,onClose:()=>_(null),onConfirm:J})]})}const he=a=>{switch(a){case"admin":return"Admin";case"recruiter":return"Recruiter";case"account_manager":return"Account Manager";case"recruitment_manager":return"Recruitment Manager";default:return a}};function Is(){const[a,R]=l.useState([]),[o,h]=l.useState(null),[j,v]=l.useState([]),[y,f]=l.useState([]),[x,_]=l.useState(!0),[m,N]=l.useState(null),[p,k]=l.useState(null),[E,$]=l.useState([]),[L,Y]=l.useState("all"),[H,J]=l.useState(""),[D,n]=l.useState("all"),[w,i]=l.useState("all"),[F,ae]=l.useState("all"),[Z,re]=l.useState(""),[W,oe]=l.useState(""),[le,r]=l.useState("all"),[b,V]=l.useState(!0),[fe,me]=l.useState(!1);l.useEffect(()=>{je()},[]),l.useEffect(()=>{ke()},[L,H,D,w,F,Z,W]),l.useEffect(()=>{Te()},[D,w]),l.useEffect(()=>{const s=setInterval(()=>{ke(),Te()},3e4);return()=>clearInterval(s)},[L,H,D,w,F,Z,W]);const je=async()=>{try{const[s,t,d]=await Promise.all([S("/api/admin/teams"),S("/api/admin/clients"),S("/api/admin/leaderboards")]);s.ok&&t.ok&&d.ok&&(v(await s.json()),f(await t.json()),h(await d.json()))}catch(s){console.error("Failed to fetch initial data:",s)}},ke=async()=>{_(!0);try{const s=new URLSearchParams;if(L!=="all"&&s.append("role",L),H&&s.append("userName",H),D!=="all"&&s.append("teamId",D),w!=="all"&&s.append("clientId",w),F==="custom"&&Z&&W)s.append("startDate",Z),s.append("endDate",W);else if(F==="today"){const d=new Date().toISOString().split("T")[0];s.append("startDate",d),s.append("endDate",d)}else if(F==="week"){const d=new Date,U=new Date(d.getTime()-10080*60*1e3);s.append("startDate",U.toISOString().split("T")[0]),s.append("endDate",d.toISOString().split("T")[0])}else if(F==="month"){const d=new Date,U=new Date(d.getTime()-720*60*60*1e3);s.append("startDate",U.toISOString().split("T")[0]),s.append("endDate",d.toISOString().split("T")[0])}const t=await S(`/api/admin/performance-stats?${s.toString()}`);if(t.ok){const d=await t.json();R(d)}}catch(s){console.error("Failed to fetch stats:",s)}finally{_(!1)}},Te=async()=>{try{const s=new URLSearchParams;D!=="all"&&s.append("team_id",D),w!=="all"&&s.append("client_id",w),s.append("status","active");const t=await S(`/api/admin/sla?${s.toString()}`);if(t.ok){const d=await t.json();k(d.metrics),$(d.roles)}}catch(s){console.error("Failed to fetch admin SLA metrics:",s)}},ze=s=>{const t=[],d=s.totalSubmissions||0,U=s.interviews1st||0,B=s.interviews2nd||0,P=s.totalInterviews||U+B,A=(s.deals||0)+(s.dealsClosedRoles||0),I=s.lostRoles||0,O=s.onHoldRoles||0,c=s.noAnswerRoles||0;return(s.dropouts||0)>0&&(t.push("Reduce dropouts with stronger qualification and preparation"),t.push("Tighten feedback cadence with hiring managers")),d>0&&U/d<.2&&t.push("Increase CV match quality and role-specific tailoring"),U>0&&B/U<.5&&t.push("Improve candidate coaching between rounds"),P>0&&A/P<.1&&t.push("Strengthen closing strategy and decision timelines"),I>0&&t.push("Analyze lost roles for preventable patterns and better fit"),c>0&&t.push("Shorten feedback loops and escalate slow responses"),O>0&&t.push("Re-qualify on-hold roles and reset expectations"),t.length===0&&t.push("Maintain current best practices and monitor conversions"),t},xe=s=>{switch(s){case"Excellent":return"text-green-700 bg-green-100";case"Good":return"text-blue-700 bg-blue-100";case"Average":return"text-yellow-700 bg-yellow-100";case"Needs Improvement":return"text-orange-700 bg-orange-100";default:return"text-gray-700 bg-gray-100"}},Be=a.length,G=a.length>0?a.reduce((s,t)=>s+t.ebesScore,0)/a.length:0,z=a.reduce((s,t)=>s+(t.totalSubmissions||0),0),M=a.reduce((s,t)=>s+(t.deals||0)+(t.dealsClosedRoles||0)+(t.totalDeals||0),0),qe=(s,t)=>{const d={user_info:["Name","User Code","Email","Role"],ebes_score:["EBES Score","Performance"],teams:["Teams"],clients:["Clients"],total_roles:["Total Roles"],active_roles:["Active Roles"],non_active_roles:["Non-Active Roles"],submissions:["Submissions"],interviews_1:["Interview 1"],interviews_2:["Interview 2"],total_interviews:["Total Interviews"],deals:["Deals"],dropouts:["Dropouts"],lost_roles:["Lost Roles"],on_hold_roles:["On Hold Roles"],no_answer_roles:["No Answer Roles"],managed_teams:["Teams Managed"],total_recruiters:["Recruiters"]},U=[];t.forEach(c=>{const g=d[c];g&&U.push(...g)});const B=s.map(c=>{const g=[];return t.forEach(u=>{u==="user_info"?g.push(c.name,c.user_code,c.email,he(c.role)):u==="ebes_score"?g.push(String(c.ebesScore),c.performanceLabel):u==="teams"?g.push(c.teams.map(Q=>Q.name).join(", ")):u==="clients"?g.push(c.clients.map(Q=>Q.name).join(", ")):u==="total_roles"?g.push(String(c.totalRoles||0)):u==="active_roles"?g.push(String(c.activeRoles||0)):u==="non_active_roles"?g.push(String(c.nonActiveRoles||0)):u==="submissions"?g.push(String(c.totalSubmissions||0)):u==="interviews_1"?g.push(String(c.interviews1st||0)):u==="interviews_2"?g.push(String(c.interviews2nd||0)):u==="total_interviews"?g.push(String(c.totalInterviews||0)):u==="deals"?g.push(String((c.deals||0)+(c.dealsClosedRoles||0))):u==="dropouts"?g.push(String(c.dropouts||0)):u==="lost_roles"?g.push(String(c.lostRoles||0)):u==="on_hold_roles"?g.push(String(c.onHoldRoles||0)):u==="no_answer_roles"?g.push(String(c.noAnswerRoles||0)):u==="managed_teams"?g.push(String(c.managedTeams||0)):u==="total_recruiters"&&g.push(String(c.totalRecruiters||0))}),`<tr>${g.map(u=>`<td style="padding:8px;border:1px solid #ddd;">${u}</td>`).join("")}</tr>`}).join(""),P=`<!doctype html><html><head><meta charset="utf-8"><title>EBES Report</title></head><body><h2>EBES Performance Report</h2><table style="border-collapse:collapse;width:100%"><thead><tr>${U.map(c=>`<th style="padding:8px;border:1px solid #ddd;text-align:left">${c}</th>`).join("")}</tr></thead><tbody>${B}</tbody></table></body></html>`,A=new Blob([P],{type:"text/html"}),I=URL.createObjectURL(A),O=window.open(I);O&&O.addEventListener("load",()=>{O.print()})},K=a.reduce((s,t)=>s+(t.totalInterviews||0),0),X=a.reduce((s,t)=>s+(t.dropouts||0),0),He=async(s,t)=>{try{const d=new URLSearchParams;if(s.role!=="all"&&d.append("role",s.role),s.searchTerm&&d.append("userName",s.searchTerm),s.teamId!=="all"&&d.append("teamId",s.teamId),s.clientId!=="all"&&d.append("clientId",s.clientId),s.dateRange==="custom"&&s.startDate&&s.endDate)d.append("startDate",s.startDate),d.append("endDate",s.endDate);else if(s.dateRange==="today"){const I=new Date().toISOString().split("T")[0];d.append("startDate",I),d.append("endDate",I)}else if(s.dateRange==="week"){const I=new Date,O=new Date(I.getTime()-10080*60*1e3);d.append("startDate",O.toISOString().split("T")[0]),d.append("endDate",I.toISOString().split("T")[0])}else if(s.dateRange==="month"){const I=new Date,O=new Date(I.getTime()-720*60*60*1e3);d.append("startDate",O.toISOString().split("T")[0]),d.append("endDate",I.toISOString().split("T")[0])}const U=await S(`/api/admin/performance-stats?${d.toString()}`);if(!U.ok)throw new Error("Failed to fetch data");const B=await U.json(),P=s.performanceLevel!=="all"?B.filter(I=>I.performanceLabel===s.performanceLevel):B,A=s.fields&&s.fields.length>0?s.fields:["user_info","ebes_score","teams","clients","total_roles","active_roles","non_active_roles","submissions","interviews_1","interviews_2","total_interviews","deals","dropouts","lost_roles","on_hold_roles","no_answer_roles","managed_teams","total_recruiters"];t==="csv"?Je(P,A):t==="excel"?Ge(P,A):qe(P,A)}catch(d){console.error("Failed to download report:",d),alert("Failed to download report. Please try again.")}},Je=(s,t)=>{const d=[],U={user_info:["Name","User Code","Email","Role"],ebes_score:["EBES Score","Performance Level"],teams:["Teams"],clients:["Clients"],total_roles:["Total Roles"],active_roles:["Active Roles"],non_active_roles:["Non-Active Roles"],submissions:["Submissions"],interviews_1:["Interview Round 1"],interviews_2:["Interview Round 2"],interviews_3:["Interview Round 3"],total_interviews:["Total Interviews"],deals:["Deals"],dropouts:["Dropouts"],lost_roles:["Lost Roles"],on_hold_roles:["On Hold Roles"],no_answer_roles:["No Answer Roles"],managed_teams:["Teams Managed"],total_recruiters:["Recruiters"]},B=[];t.forEach(c=>{const g=U[c];g&&B.push(...g)}),d.push(B.join(",")),s.forEach(c=>{const g=[];t.forEach(u=>{u==="user_info"?g.push(`"${c.name}"`,c.user_code,c.email,he(c.role)):u==="ebes_score"?g.push(String(c.ebesScore),c.performanceLabel):u==="teams"?g.push(`"${c.teams.map(Q=>Q.name).join("; ")}"`):u==="clients"?g.push(`"${c.clients.map(Q=>Q.name).join("; ")}"`):u==="total_roles"?g.push(String(c.totalRoles||0)):u==="active_roles"?g.push(String(c.activeRoles||0)):u==="non_active_roles"?g.push(String(c.nonActiveRoles||0)):u==="submissions"?g.push(String(c.totalSubmissions||0)):u==="interviews_1"?g.push(String(c.interviews1st||0)):u==="interviews_2"?g.push(String(c.interviews2nd||0)):u==="interviews_3"?g.push(String(c.interviews3rd||0)):u==="total_interviews"?g.push(String(c.totalInterviews||0)):u==="deals"?g.push(String((c.deals||0)+(c.dealsClosedRoles||0))):u==="dropouts"?g.push(String(c.dropouts||0)):u==="lost_roles"?g.push(String(c.lostRoles||0)):u==="on_hold_roles"?g.push(String(c.onHoldRoles||0)):u==="no_answer_roles"?g.push(String(c.noAnswerRoles||0)):u==="managed_teams"?g.push(String(c.managedTeams||0)):u==="total_recruiters"&&g.push(String(c.totalRecruiters||0))}),d.push(g.join(","))});const P=d.join(`
`),A=new Blob([P],{type:"text/csv;charset=utf-8;"}),I=window.URL.createObjectURL(A),O=document.createElement("a");O.href=I,O.download=`ebes-performance-report-${new Date().toISOString().split("T")[0]}.csv`,O.click(),window.URL.revokeObjectURL(I)},Ge=(s,t)=>{const d=[];d.push(`"EBES Performance Report - Generated on ${new Date().toLocaleDateString()}"`),d.push("");const U=s.length,B=s.length>0?s.reduce((C,T)=>C+T.ebesScore,0)/s.length:0,P=s.reduce((C,T)=>C+(T.totalSubmissions||0),0),A=s.reduce((C,T)=>C+(T.totalInterviews||0),0),I=s.reduce((C,T)=>C+(T.deals||0)+(T.dealsClosedRoles||0)+(T.totalDeals||0),0);d.push("Summary Statistics"),d.push(`Total Users,${U}`),d.push(`Average EBES Score,${B.toFixed(2)}`),d.push(`Total Submissions,${P}`),d.push(`Total Interviews,${A}`),d.push(`Total Deals,${I}`),d.push("");const O={user_info:["Name","User Code","Email","Role"],ebes_score:["EBES Score","Performance"],teams:["Teams"],clients:["Clients"],total_roles:["Total Roles"],active_roles:["Active Roles"],submissions:["Submissions"],interviews_1:["Interview 1"],interviews_2:["Interview 2"],interviews_3:["Interview 3"],total_interviews:["Total Interviews"],deals:["Deals"],dropouts:["Dropouts"],lost_roles:["Lost"],on_hold_roles:["On Hold"],no_answer_roles:["No Answer"]},c=[];t.forEach(C=>{const T=O[C];T&&c.push(...T)}),d.push(c.join(",")),s.forEach(C=>{const T=[];t.forEach(q=>{q==="user_info"?T.push(`"${C.name}"`,C.user_code,C.email,he(C.role)):q==="ebes_score"?T.push(String(C.ebesScore),C.performanceLabel):q==="teams"?T.push(`"${C.teams.map(Ne=>Ne.name).join("; ")}"`):q==="clients"?T.push(`"${C.clients.map(Ne=>Ne.name).join("; ")}"`):q==="total_roles"?T.push(String(C.totalRoles||0)):q==="active_roles"?T.push(String(C.activeRoles||0)):q==="submissions"?T.push(String(C.totalSubmissions||0)):q==="interviews_1"?T.push(String(C.interviews1st||0)):q==="interviews_2"?T.push(String(C.interviews2nd||0)):q==="interviews_3"?T.push(String(C.interviews3rd||0)):q==="total_interviews"?T.push(String(C.totalInterviews||0)):q==="deals"?T.push(String((C.deals||0)+(C.dealsClosedRoles||0))):q==="dropouts"?T.push(String(C.dropouts||0)):q==="lost_roles"?T.push(String(C.lostRoles||0)):q==="on_hold_roles"?T.push(String(C.onHoldRoles||0)):q==="no_answer_roles"&&T.push(String(C.noAnswerRoles||0))}),d.push(T.join(","))});const g=d.join(`
`),u=new Blob([g],{type:"application/vnd.ms-excel;charset=utf-8;"}),Q=window.URL.createObjectURL(u),ye=document.createElement("a");ye.href=Q,ye.download=`ebes-performance-report-${new Date().toISOString().split("T")[0]}.csv`,ye.click(),window.URL.revokeObjectURL(Q)},Ee=[{name:"Recruiters",value:a.filter(s=>s.role==="recruiter").length,color:"#3b82f6"},{name:"Account Managers",value:a.filter(s=>s.role==="account_manager").length,color:"#8b5cf6"},{name:"Recruitment Managers",value:a.filter(s=>s.role==="recruitment_manager").length,color:"#10b981"},{name:"Admins",value:a.filter(s=>s.role==="admin").length,color:"#f59e0b"}].filter(s=>s.value>0),Ae=[{name:"Excellent",value:a.filter(s=>s.performanceLabel==="Excellent").length,color:"#10b981"},{name:"Good",value:a.filter(s=>s.performanceLabel==="Good").length,color:"#3b82f6"},{name:"Average",value:a.filter(s=>s.performanceLabel==="Average").length,color:"#f59e0b"},{name:"Needs Improvement",value:a.filter(s=>s.performanceLabel==="Needs Improvement").length,color:"#ef4444"}].filter(s=>s.value>0),We=[{role:"Recruiters",avgScore:a.filter(s=>s.role==="recruiter").reduce((s,t)=>s+t.ebesScore,0)/Math.max(a.filter(s=>s.role==="recruiter").length,1),count:a.filter(s=>s.role==="recruiter").length},{role:"Account Managers",avgScore:a.filter(s=>s.role==="account_manager").reduce((s,t)=>s+t.ebesScore,0)/Math.max(a.filter(s=>s.role==="account_manager").length,1),count:a.filter(s=>s.role==="account_manager").length},{role:"Recruitment Managers",avgScore:a.filter(s=>s.role==="recruitment_manager").reduce((s,t)=>s+t.ebesScore,0)/Math.max(a.filter(s=>s.role==="recruitment_manager").length,1),count:a.filter(s=>s.role==="recruitment_manager").length}].filter(s=>s.count>0),De=le==="all"?a:a.filter(s=>s.performanceLabel===le);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ts,{isOpen:fe,onClose:()=>me(!1),teams:j,clients:y,onDownload:He,allowedRoles:["admin","account_manager","recruitment_manager","recruiter"]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Performance Statistics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive performance metrics for all users"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>V(!b),className:"flex items-center gap-2 px-4 py-2 bg-white border-2 border-gray-200 text-gray-700 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all",children:[e.jsx(de,{className:"w-4 h-4"}),b?"Hide":"Show"," Charts"]}),e.jsxs("button",{onClick:()=>me(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-lg transition-all shadow-lg",children:[e.jsx(as,{className:"w-4 h-4"}),"Download Report"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ve,{className:"w-8 h-8 opacity-80"}),e.jsx("span",{className:"text-2xl font-bold",children:G.toFixed(1)})]}),e.jsx("p",{className:"text-indigo-100 text-sm font-medium",children:"Avg EBES Score"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ne,{className:"w-8 h-8 opacity-80"}),e.jsx("span",{className:"text-2xl font-bold",children:Be})]}),e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Total Users"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ge,{className:"w-8 h-8 opacity-80"}),e.jsx("span",{className:"text-2xl font-bold",children:z})]}),e.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"Total Submissions"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Le,{className:"w-8 h-8 opacity-80"}),e.jsx("span",{className:"text-2xl font-bold",children:M})]}),e.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Total Deals"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(rs,{className:"w-8 h-8 text-blue-600"}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:K})]}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Total Interviews"}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:z>0&&`${(K/z*100).toFixed(1)}% conversion rate`})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-yellow-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ls,{className:"w-8 h-8 text-yellow-600"}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:X})]}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Total Dropouts"}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:M>0&&`${(X/(M+X)*100).toFixed(1)}% dropout rate`})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border-2 border-green-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ge,{className:"w-8 h-8 text-green-600"}),e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[K>0?((a.reduce((s,t)=>s+(t.interviews2nd||0)+(t.interviews3rd||0),0)+M)/K*100).toFixed(1):0,"%"]})]}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Interview Success"})]})]}),b&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(ne,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"User Distribution by Role"})]}),e.jsx(we,{width:"100%",height:300,children:e.jsxs($e,{children:[e.jsx(Fe,{data:Ee,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:t})=>`${s}: ${t}`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:Ee.map((s,t)=>e.jsx(Ie,{fill:s.color},`cell-${t}`))}),e.jsx(Se,{})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(ve,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Performance Distribution"})]}),e.jsx(we,{width:"100%",height:300,children:e.jsxs($e,{children:[e.jsx(Fe,{data:Ae,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:t})=>`${s}: ${t}`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:Ae.map((s,t)=>e.jsx(Ie,{fill:s.color},`cell-${t}`))}),e.jsx(Se,{})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(de,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Average EBES Score by Role"})]}),e.jsx(we,{width:"100%",height:300,children:e.jsxs(ns,{data:We,children:[e.jsx(is,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(os,{dataKey:"role",stroke:"#6b7280",tick:{fontSize:12}}),e.jsx(ds,{stroke:"#6b7280",domain:[0,100]}),e.jsx(Se,{contentStyle:{backgroundColor:"#fff",border:"2px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(cs,{dataKey:"avgScore",fill:"#6366f1",name:"Average EBES Score",radius:[8,8,0,0]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Me,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Key Performance Metrics"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Submission to Interview"}),e.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[z>0?(K/z*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 h-3 rounded-full transition-all",style:{width:`${Math.min(z>0?K/z*100:0,100)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Interview Success"}),e.jsxs("span",{className:"text-sm font-bold text-green-600",children:[K>0?((a.reduce((s,t)=>s+(t.interviews2nd||0)+(t.interviews3rd||0),0)+M)/K*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all",style:{width:`${Math.min(K>0?(a.reduce((s,t)=>s+(t.interviews2nd||0)+(t.interviews3rd||0),0)+M)/K*100:0,100)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Overall Win Rate"}),e.jsxs("span",{className:"text-sm font-bold text-purple-600",children:[z>0?(M/z*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all",style:{width:`${Math.min(z>0?M/z*100:0,100)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Retention Rate"}),e.jsxs("span",{className:"text-sm font-bold text-indigo-600",children:[M+X>0?(M/(M+X)*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-blue-500 h-3 rounded-full transition-all",style:{width:`${Math.min(M+X>0?M/(M+X)*100:0,100)}%`}})})]})]})]})]}),p&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(ms,{className:"w-5 h-5"}),"Role Aging & SLA (Org)"]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Organization-wide role aging and responsiveness"})]})})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Avg Days Open"}),e.jsx("div",{className:"text-2xl font-bold text-slate-800",children:p.avg_days_open})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-red-600 mb-1",children:"Roles ≥14d"}),e.jsx("div",{className:"text-2xl font-bold text-red-700",children:p.roles_over_14})]}),e.jsxs("div",{className:"bg-red-100 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-red-700 mb-1",children:"Roles ≥30d"}),e.jsx("div",{className:"text-2xl font-bold text-red-800",children:p.roles_over_30})]}),e.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-emerald-600 mb-1",children:"Avg Time to 1st Submission (days)"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:p.avg_time_to_first_submission})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-indigo-600 mb-1",children:"Avg Time to 1st Interview (days)"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-700",children:p.avg_time_to_first_interview})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"Role"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"Status"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"Days Open"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"First Submission (days)"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"First Interview (days)"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-500",children:"Dropout"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:E.map(s=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-4 py-2",children:[e.jsx("div",{className:"text-sm font-medium text-slate-800",children:s.title}),e.jsx("div",{className:"text-xs text-slate-500",children:s.role_code})]}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"text-xs px-2 py-1 rounded-full border",children:s.status})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:s.days_open})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"text-sm text-slate-800",children:s.first_submission_days??"-"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"text-sm text-slate-800",children:s.first_interview_days??"-"})}),e.jsx("td",{className:"px-4 py-2",children:s.has_dropout?e.jsx("span",{className:`text-xs px-2 py-1 rounded-full border ${s.dropout_decision==="accepted"?"bg-green-50 text-green-700 border-green-200":s.dropout_decision==="rejected"?"bg-red-50 text-red-700 border-red-200":"bg-yellow-50 text-yellow-700 border-yellow-200"}`,children:s.dropout_decision||"completed"}):e.jsx("span",{className:"text-xs text-slate-500",children:"—"})})]},s.id))})]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 group cursor-help relative",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center",children:e.jsx(de,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Performance Insights"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Key observations across all teams"})]}),e.jsx(Ue,{className:"w-5 h-5 text-blue-400 hover:text-blue-600 transition-colors ml-auto"}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 right-8 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Organization Performance Insights"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:"High-level view of organization-wide performance metrics. Identify top performers to recognize, average trends to maintain, and areas requiring intervention. Hover over each insight card for detailed recommendations."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200 group cursor-help relative",children:[e.jsx("p",{className:"font-semibold text-blue-900 mb-2",children:"Top Performers"}),e.jsxs("p",{className:"text-sm text-blue-800",children:[a.filter(s=>s.ebesScore>=90).length," user(s) with excellent EBES scores (90+)"]}),e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Excellence Recognition"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:a.filter(s=>s.ebesScore>=90).length>0?`Recognize these ${a.filter(s=>s.ebesScore>=90).length} top performer(s) publicly. Consider them for mentorship roles, special projects, or leadership development. Document and share their best practices with the broader team.`:"No users currently at excellence level (90+). Set this as an aspirational target and create development programs to help team members reach it."})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200 group cursor-help relative",children:[e.jsx("p",{className:"font-semibold text-blue-900 mb-2",children:"Average Performance"}),e.jsxs("p",{className:"text-sm text-blue-800",children:["Organization average EBES: ",G.toFixed(1)," -",G>=80?" Strong":G>=70?" Good":" Needs Improvement"]}),e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Organization Health"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:G>=80?`Excellent organization-wide performance at ${G.toFixed(1)}. Maintain this through continued training, recognition programs, and process optimization.`:G>=70?`Good baseline at ${G.toFixed(1)}. Target: raise to 80+ through focused coaching on underperforming areas and scaling best practices from top performers.`:`Performance below target at ${G.toFixed(1)}. Urgent: conduct skills gap analysis, implement training programs, and provide intensive coaching to raise organizational capability.`})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200 group cursor-help relative",children:[e.jsx("p",{className:"font-semibold text-blue-900 mb-2",children:"Attention Needed"}),e.jsxs("p",{className:"text-sm text-blue-800",children:[a.filter(s=>s.ebesScore<60).length," user(s) require coaching and support"]}),e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Support Requirements"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:a.filter(s=>s.ebesScore<60).length>0?`${a.filter(s=>s.ebesScore<60).length} user(s) need immediate support. Schedule 1-on-1 coaching sessions, create personalized improvement plans, pair with mentors, and track weekly progress. Consider if role fit or training gaps are issues.`:"No users currently at-risk. Maintain this through proactive check-ins, regular training, and early intervention when performance trends downward."})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl shadow-lg border-2 border-indigo-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 group cursor-help relative",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center",children:e.jsx(xs,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Recommended Corrective Actions"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Strategic initiatives to improve organization performance"})]}),e.jsx(Ue,{className:"w-5 h-5 text-gray-400 hover:text-gray-600 transition-colors ml-auto"}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsx("div",{className:"absolute -top-2 right-8 w-4 h-4 bg-gray-900 transform rotate-45"}),e.jsx("p",{className:"font-semibold mb-2",children:"Strategic Action Plan"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:"Organization-wide recommendations based on performance data, industry benchmarks, and best practices. Prioritize high-priority actions for maximum impact on team performance."})]})]}),e.jsx("div",{className:"space-y-4",children:(()=>{const s=[],t=a.filter(A=>A.ebesScore<60),d=a.filter(A=>A.role==="recruiter"),U=d.length>0?d.reduce((A,I)=>A+I.ebesScore,0)/d.length:0,B=z>0?M/z*100:0;t.length>a.length*.2&&s.push({priority:"high",title:"Address Widespread Performance Issues",description:`${t.length} users (${(t.length/a.length*100).toFixed(0)}%) performing below expectations (EBES < 60).`,steps:["Conduct organization-wide performance review and root cause analysis","Identify common gaps: training, tools, processes, or role clarity?","Launch comprehensive training program addressing identified gaps","Implement weekly coaching sessions for all underperformers","Create peer mentorship program pairing high and low performers","Set 30-day improvement targets with milestone check-ins","Consider if organizational structure or resource allocation needs adjustment"],impact:`Raise ${t.length} user(s) above 60 EBES threshold within 60 days`}),G<70&&s.push({priority:"high",title:"Improve Organization-Wide Performance",description:`Organization average EBES of ${G.toFixed(1)} below industry standard (75-80).`,steps:["Analyze top 20% performers - what are they doing differently?","Document and standardize successful practices as playbooks","Conduct skills assessment across all roles to identify training needs","Implement monthly performance workshops and knowledge sharing","Review and optimize internal processes that may be bottlenecks","Set clear performance standards and expectations for each role","Track progress monthly with transparent dashboards"],impact:`Increase organization average from ${G.toFixed(1)} to 75+ within 90 days`}),B<10&&z>50&&s.push({priority:"high",title:"Improve Overall Win Rate",description:`Success rate of ${B.toFixed(1)}% is below industry benchmark (12-15%). ${z} submissions yielding only ${M} deals.`,steps:["Review client selection and qualification process","Improve candidate screening and quality standards","Enhance interview preparation and candidate coaching","Speed up feedback loops and decision-making processes","Strengthen hiring manager relationships and expectation setting","Analyze lost deals to identify preventable patterns","Consider specialization by industry or role type"],impact:`Increase success rate to 12%+, adding ${Math.round((.12-B/100)*z)} deals with same activity`});const P=M+X>0?X/(M+X)*100:0;return P>20&&s.push({priority:"high",title:"Reduce Organization-Wide Dropout Rate",description:`${P.toFixed(1)}% dropout rate (${X} dropouts vs ${M} deals) impacts team morale and EBES scores.`,steps:["Conduct exit interviews with all recent dropouts to identify patterns","Common causes: offer acceptance issues, counter-offers, or role misalignment?","Implement comprehensive pre-submission candidate vetting checklist","Train team on candidate commitment assessment techniques","Improve offer negotiation and closing strategies organization-wide","Establish post-offer acceptance engagement protocols","Track dropout reasons in CRM for ongoing analysis"],impact:`Reduce dropout rate from ${P.toFixed(1)}% to under 15%, saving ${Math.round((P-15)/100*X)} placements`}),U<65&&d.length>0&&s.push({priority:"medium",title:"Strengthen Recruiter Team Performance",description:`Recruiter average EBES of ${U.toFixed(1)} below target. ${d.length} recruiters need support.`,steps:["Launch recruiter-specific training: sourcing, screening, candidate engagement","Implement daily stand-ups for pipeline review and problem-solving","Create clear submission quality standards and checklists","Pair struggling recruiters with top performers for shadowing","Review and optimize role assignments - are they well-matched?","Provide better tools and resources (ATS, sourcing platforms, templates)","Celebrate and reward improvement with recognition program"],impact:`Raise recruiter average from ${U.toFixed(1)} to 70+ within 60 days`}),(s.length===0||G>=80&&t.length<a.length*.1)&&s.push({priority:"low",title:"Sustain and Scale High Performance",description:`Strong organization performance: ${G.toFixed(1)} average EBES, ${a.filter(A=>A.ebesScore>=90).length} top performers.`,steps:["Document success: create case studies of high-performing teams","Launch formal mentorship program with top performers as mentors","Invest in leadership development for high potentials","Explore market expansion or new service offerings","Maintain current excellence through continuous improvement culture","Share organizational success stories for recruitment and client acquisition","Set aspirational stretch goals: 85+ organization average"],impact:"Scale success, prepare for growth, and maintain competitive advantage"}),s.map((A,I)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-slate-200 p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase border-2 ${A.priority==="high"?"bg-red-100 text-red-700 border-red-300":A.priority==="medium"?"bg-yellow-100 text-yellow-700 border-yellow-300":"bg-blue-100 text-blue-700 border-blue-300"}`,children:[A.priority," Priority"]})}),e.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:A.title}),e.jsx("p",{className:"text-sm text-slate-600",children:A.description})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-bold text-slate-700 mb-2",children:"Action Steps:"}),e.jsx("ul",{className:"space-y-2",children:A.steps.map((O,c)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Le,{className:"w-4 h-4 text-indigo-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm text-slate-700",children:O})]},c))})]}),e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-indigo-600"}),e.jsx("span",{className:"text-sm font-semibold text-indigo-800",children:"Expected Impact:"})]}),e.jsx("p",{className:"text-sm text-indigo-700 mt-1",children:A.impact})]})]},I))})()})]}),o&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(hs,{className:"w-5 h-5 text-yellow-600"}),e.jsx("h3",{className:"font-bold text-gray-900",children:"Top Recruiters"})]}),e.jsx("div",{className:"space-y-2",children:o.recruiters.slice(0,5).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t===0&&e.jsx("span",{className:"text-xl",children:"🥇"}),t===1&&e.jsx("span",{className:"text-xl",children:"🥈"}),t===2&&e.jsx("span",{className:"text-xl",children:"🥉"}),t>2&&e.jsxs("span",{className:"text-gray-500 font-medium w-6",children:["#",t+1]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.team})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-indigo-600 text-sm",children:s.ebesScore}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${xe(s.performanceLabel)}`,children:s.performanceLabel})]})]},t))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ws,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-bold text-gray-900",children:"Top Account Managers"})]}),e.jsx("div",{className:"space-y-2",children:o.accountManagers.slice(0,5).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t===0&&e.jsx("span",{className:"text-xl",children:"🥇"}),t===1&&e.jsx("span",{className:"text-xl",children:"🥈"}),t===2&&e.jsx("span",{className:"text-xl",children:"🥉"}),t>2&&e.jsxs("span",{className:"text-gray-500 font-medium w-6",children:["#",t+1]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.team})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-indigo-600 text-sm",children:s.ebesScore}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${xe(s.performanceLabel)}`,children:s.performanceLabel})]})]},t))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ve,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"font-bold text-gray-900",children:"Top Recruitment Managers"})]}),e.jsx("div",{className:"space-y-2",children:o.recruitmentManagers.slice(0,5).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t===0&&e.jsx("span",{className:"text-xl",children:"🥇"}),t===1&&e.jsx("span",{className:"text-xl",children:"🥈"}),t===2&&e.jsx("span",{className:"text-xl",children:"🥉"}),t>2&&e.jsxs("span",{className:"text-gray-500 font-medium w-6",children:["#",t+1]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.team})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-indigo-600 text-sm",children:s.ebesScore}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${xe(s.performanceLabel)}`,children:s.performanceLabel})]})]},t))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Pe,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:L,onChange:s=>Y(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"recruiter",children:"Recruiter"}),e.jsx("option",{value:"account_manager",children:"Account Manager"}),e.jsx("option",{value:"recruitment_manager",children:"Recruitment Manager"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Performance Level"}),e.jsxs("select",{value:le,onChange:s=>r(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Levels"}),e.jsx("option",{value:"Excellent",children:"Excellent"}),e.jsx("option",{value:"Good",children:"Good"}),e.jsx("option",{value:"Average",children:"Average"}),e.jsx("option",{value:"Needs Improvement",children:"Needs Improvement"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Team"}),e.jsxs("select",{value:D,onChange:s=>n(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Teams"}),j.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.team_code,")"]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),e.jsxs("select",{value:w,onChange:s=>i(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Clients"}),y.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.client_code,")"]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{value:F,onChange:s=>ae(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"custom",children:"Custom Range"})]})]}),F==="custom"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:Z,onChange:s=>re(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:W,onChange:s=>oe(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search User"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:H,onChange:s=>J(s.target.value),placeholder:"Name, email, or code...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"User Performance Details"})}),x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"User"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Team"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Client(s)"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"EBES Score"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"Performance"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"Details"})]})}),e.jsx("tbody",{children:De.map(s=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>N(m===s.user_id?null:s.user_id),children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.user_code})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-sm text-gray-700",children:he(s.role)})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-700",children:s.teams.length>0?s.teams.map(t=>t.name).join(", "):"No Team"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"text-sm text-gray-700",children:s.clients.length>0?s.clients.map(t=>t.name).join(", "):"No Clients"})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"font-bold text-indigo-600 text-lg",children:s.ebesScore})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${xe(s.performanceLabel)}`,children:s.performanceLabel})}),e.jsx("td",{className:"py-3 px-4 text-center",children:m===s.user_id?e.jsx(js,{className:"w-5 h-5 text-gray-400 mx-auto"}):e.jsx(bs,{className:"w-5 h-5 text-gray-400 mx-auto"})})]},s.user_id),m===s.user_id&&e.jsx("tr",{className:"bg-gray-50",children:e.jsxs("td",{colSpan:7,className:"py-4 px-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.role==="recruiter"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Submissions"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:s.totalSubmissions})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Interviews"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:s.totalInterviews}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["1st: ",s.interviews1st," | 2nd: ",s.interviews2nd," | 3rd:"," ",s.interviews3rd]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Deals"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:s.deals})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Drop Outs"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:s.dropouts})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Active Roles"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:s.activeRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Non-Active Roles"}),e.jsx("p",{className:"text-xl font-bold text-gray-600",children:s.nonActiveRoles})]})]}),s.role==="account_manager"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Roles"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:s.totalRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Active Roles"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:s.activeRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Deals Closed"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:s.dealsClosedRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Lost Roles"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:s.lostRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"On Hold"}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:s.onHoldRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"No Answer"}),e.jsx("p",{className:"text-xl font-bold text-gray-600",children:s.noAnswerRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Interviews"}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:s.totalInterviews})]})]}),s.role==="recruitment_manager"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Teams Managed"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:s.managedTeams})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Recruiters"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:s.totalRecruiters})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Roles"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:s.totalRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Active Roles"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:s.activeRoles})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Deals"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:s.totalDeals})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Interviews"}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:s.totalInterviews})]})]})]}),e.jsxs("div",{className:"mt-4 bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Corrective Actions"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700",children:ze(s).map((t,d)=>e.jsx("li",{children:t},d))})]})]})})]}))})]}),De.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_e,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No users found matching your filters"})]})]})]})]})}function Us(){const[a,R]=l.useState(!0),[o,h]=l.useState(!0),[j,v]=l.useState(!0),[y,f]=l.useState(!0),[x,_]=l.useState(!0),[m,N]=l.useState(!0),[p,k]=l.useState(!0),[E,$]=l.useState(!1);l.useEffect(()=>{L()},[]);const L=async()=>{try{const n=await S("/api/company/settings");if(n.ok){const i=await n.json();R(i.show_company_page)}const w=await S("/api/admin/profile-settings");if(w.ok){const i=await w.json();h(i.show_employee_profiles),v(i.show_recruiter_stats),f(i.show_rm_stats),_(i.show_am_stats),N(i.show_client_stats),k(i.show_team_stats)}}catch(n){console.error("Failed to fetch settings:",n)}},Y=async()=>{try{$(!0);const n=!a;(await S("/api/company/settings",{method:"PUT",body:JSON.stringify({show_company_page:n})})).ok&&(R(n),window.location.reload())}catch(n){console.error("Failed to update settings:",n)}finally{$(!1)}},H=async()=>{try{$(!0);const n=!o;(await S("/api/admin/profile-settings",{method:"PUT",body:JSON.stringify({show_employee_profiles:n,show_recruiter_stats:n?j:!1,show_rm_stats:n?y:!1,show_am_stats:n?x:!1,show_client_stats:n?m:!1,show_team_stats:n?p:!1})})).ok&&(h(n),n||(v(!1),f(!1),_(!1),N(!1),k(!1)),window.location.reload())}catch(n){console.error("Failed to update settings:",n)}finally{$(!1)}},J=async(n,w)=>{try{$(!0);const i=!w;if((await S("/api/admin/profile-settings",{method:"PUT",body:JSON.stringify({show_employee_profiles:o,show_recruiter_stats:n==="show_recruiter_stats"?i:j,show_rm_stats:n==="show_rm_stats"?i:y,show_am_stats:n==="show_am_stats"?i:x,show_client_stats:n==="show_client_stats"?i:m,show_team_stats:n==="show_team_stats"?i:p})})).ok)switch(n){case"show_recruiter_stats":v(i);break;case"show_rm_stats":f(i);break;case"show_am_stats":_(i);break;case"show_client_stats":N(i);break;case"show_team_stats":k(i);break}}catch(i){console.error("Failed to update settings:",i)}finally{$(!1)}},D=({enabled:n,onClick:w,disabled:i=!1})=>e.jsx("button",{onClick:w,disabled:i||E,className:`relative inline-flex items-center h-8 w-16 rounded-full transition-colors ${n?"bg-emerald-500":"bg-slate-300"} ${i||E?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("span",{className:`inline-block w-6 h-6 transform rounded-full bg-white shadow-lg transition-transform ${n?"translate-x-9":"translate-x-1"}`})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Settings"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage application settings and visibility controls"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center",children:e.jsx(Oe,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Company Page Visibility"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Control access to the Company Page for all users"})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Show Company Page to Users"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"When enabled, the Company Page option will be visible in the side menu for all users."}),e.jsx("p",{className:"text-sm text-slate-600",children:"When disabled, the Company Page option will be hidden from all users."})]}),e.jsx(D,{enabled:a,onClick:Y})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${a?"bg-emerald-500":"bg-slate-400"}`}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Current Status: ",a?"Visible to All Users":"Hidden from All Users"]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center",children:e.jsx(ne,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Employee Profiles & Statistics"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Control what users can see about other employees"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-6 border-2 border-blue-200 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"text-lg font-semibold text-slate-800 mb-2 flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-blue-600"}),"Show Employee Profiles"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Master control for employee profile visibility. When disabled, all profile features are hidden from users."})]}),e.jsx(D,{enabled:o,onClick:H})]})}),e.jsxs("div",{className:`space-y-4 transition-opacity ${o?"opacity-100":"opacity-50"}`,children:[e.jsx("p",{className:"text-sm font-semibold text-slate-700 mb-4",children:"Configure what statistics are visible in employee profiles:"}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-800",children:"Recruiter Statistics"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Show EBES scores, submissions, interviews, and deals"})]})]}),e.jsx(D,{enabled:j,onClick:()=>J("show_recruiter_stats",j),disabled:!o})]})}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(ne,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-800",children:"Recruitment Manager Statistics"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Show EBES scores, team performance, and analytics"})]})]}),e.jsx(D,{enabled:y,onClick:()=>J("show_rm_stats",y),disabled:!o})]})}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:e.jsx(de,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-800",children:"Account Manager Statistics"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Show EBES scores, roles, interviews, and conversions"})]})]}),e.jsx(D,{enabled:x,onClick:()=>J("show_am_stats",x),disabled:!o})]})}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(ue,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-800",children:"Client Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Show assigned clients and client performance data"})]})]}),e.jsx(D,{enabled:m,onClick:()=>J("show_client_stats",m),disabled:!o})]})}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center",children:e.jsx(pe,{className:"w-5 h-5 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-800",children:"Team Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Show team assignments and team performance metrics"})]})]}),e.jsx(D,{enabled:p,onClick:()=>J("show_team_stats",p),disabled:!o})]})})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${o?"bg-emerald-500":"bg-slate-400"}`}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Profiles: ",o?"On":"Off"]})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${j?"bg-blue-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-sm text-slate-600",children:"Recruiter Stats"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${y?"bg-purple-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-sm text-slate-600",children:"RM Stats"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${x?"bg-emerald-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-sm text-slate-600",children:"AM Stats"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${m?"bg-orange-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-sm text-slate-600",children:"Client Info"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${p?"bg-pink-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-sm text-slate-600",children:"Team Info"})]})]})]})})]}),e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Ns,{className:"w-5 h-5 text-blue-600"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Important Notes"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• Changes take effect immediately for all users"}),e.jsx("li",{children:'• When the main "Employee Profiles" toggle is off, all sub-features are disabled'}),e.jsx("li",{children:"• Users can only see profiles and stats of other employees, not admins"}),e.jsx("li",{children:"• Individual stat toggles can be controlled independently when profiles are enabled"})]})]})]})})]})}function Gs(){return e.jsx(_s,{children:e.jsxs(Qe,{children:[e.jsx(ee,{path:"/",element:e.jsx(Ze,{to:"/admin/users",replace:!0})}),e.jsx(ee,{path:"/users",element:e.jsx(Ts,{})}),e.jsx(ee,{path:"/clients",element:e.jsx(As,{})}),e.jsx(ee,{path:"/teams",element:e.jsx(Ls,{})}),e.jsx(ee,{path:"/performance",element:e.jsx(Is,{})}),e.jsx(ee,{path:"/company",element:e.jsx(gs,{})}),e.jsx(ee,{path:"/settings",element:e.jsx(Us,{})})]})})}export{Gs as default};
