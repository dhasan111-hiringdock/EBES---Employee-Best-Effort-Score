import{r,j as e}from"./index-C7EJkjUr.js";import{f as c}from"./api-D8SveD0E.js";import{P,S as D,T,X as g}from"./x-yUVYYHrF.js";import{B as N}from"./building-2-Cuz0WzKd.js";import{U as L}from"./users-C13lqfXm.js";function R(){const[b,y]=r.useState([]),[v,j]=r.useState(!0),[w,i]=r.useState(!1),[C,m]=r.useState(!1),[x,u]=r.useState(null),[t,a]=r.useState({name:"",company_code:"",logo_url:""}),[_,p]=r.useState(!1),[h,f]=r.useState(null),[l,n]=r.useState({name:"",email:"",password:""});r.useEffect(()=>{d()},[]);const d=async()=>{try{j(!0);const s=await c("/api/super-admin/companies");if(s.ok){const o=await s.json();y(o)}}catch(s){console.error("Failed to fetch companies:",s)}finally{j(!1)}},k=async()=>{if(!t.name||!t.company_code){alert("Name and company code are required");return}try{const s=await c("/api/super-admin/companies",{method:"POST",body:JSON.stringify(t)});if(s.ok)i(!1),a({name:"",company_code:"",logo_url:""}),d();else{const o=await s.json();alert(o.error||"Failed to create company")}}catch(s){console.error("Failed to create company:",s),alert("Failed to create company")}},S=async()=>{if(x)try{(await c(`/api/super-admin/companies/${x.id}`,{method:"PUT",body:JSON.stringify({...t,is_active:x.is_active})})).ok&&(m(!1),u(null),a({name:"",company_code:"",logo_url:""}),d())}catch(s){console.error("Failed to update company:",s)}},A=async s=>{if(confirm(`Are you sure you want to delete ${s.name}?`))try{const o=await c(`/api/super-admin/companies/${s.id}`,{method:"DELETE"});if(o.ok)d();else{const U=await o.json();alert(U.error||"Failed to delete company")}}catch(o){console.error("Failed to delete company:",o)}},F=s=>{u(s),a({name:s.name,company_code:s.company_code,logo_url:s.logo_url||""}),m(!0)},E=s=>{f(s),p(!0)},M=async()=>{if(!h||!l.name||!l.email||!l.password){alert("All fields are required");return}try{const s=await c(`/api/super-admin/companies/${h.id}/admin`,{method:"POST",body:JSON.stringify(l)});if(s.ok)p(!1),f(null),n({name:"",email:"",password:""}),d(),alert("Admin created successfully");else{const o=await s.json();alert(o.error||"Failed to create admin")}}catch(s){console.error("Failed to create admin:",s),alert("Failed to create admin")}};return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Companies"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage all companies on the platform"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-medium hover:from-indigo-700 hover:to-purple-700 transition-all shadow-lg flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Create Company"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(s=>e.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center",children:s.logo_url?e.jsx("img",{src:s.logo_url,alt:s.name,className:"w-full h-full object-cover rounded-xl"}):e.jsx(N,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:s.company_code})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.is_active?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Admins"}),e.jsx("p",{className:"text-xl font-bold text-blue-700",children:s.admin_count})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-purple-600 mb-1",children:"Total Users"}),e.jsx("p",{className:"text-xl font-bold text-purple-700",children:s.total_users})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>E(s),className:"flex-1 px-4 py-2 bg-emerald-50 text-emerald-600 rounded-lg hover:bg-emerald-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),"Add Admin"]})}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("button",{onClick:()=>F(s),className:"flex-1 px-4 py-2 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("button",{onClick:()=>A(s),className:"flex-1 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Delete"]})]})]})},s.id))}),b.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-lg border border-slate-200",children:[e.jsx(N,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-500 mb-4",children:"No companies yet"}),e.jsx("button",{onClick:()=>i(!0),className:"text-indigo-600 hover:text-indigo-800 font-medium",children:"Create your first company"})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Create Company"}),e.jsx("button",{onClick:()=>{i(!1),a({name:"",company_code:"",logo_url:""})},className:"text-slate-400 hover:text-slate-600",children:e.jsx(g,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Company Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>a({...t,name:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Company Code *"}),e.jsx("input",{type:"text",value:t.company_code,onChange:s=>a({...t,company_code:s.target.value.toUpperCase()}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono",placeholder:"COMP001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Logo URL"}),e.jsx("input",{type:"text",value:t.logo_url,onChange:s=>a({...t,logo_url:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"https://example.com/logo.png"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{i(!1),a({name:"",company_code:"",logo_url:""})},className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:k,className:"flex-1 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg font-medium hover:from-indigo-700 hover:to-purple-700 transition-all",children:"Create"})]})]})]})}),_&&h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Create Admin"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["For ",h.name]})]}),e.jsx("button",{onClick:()=>{p(!1),f(null),n({name:"",email:"",password:""})},className:"text-slate-400 hover:text-slate-600",children:e.jsx(g,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",value:l.name,onChange:s=>n({...l,name:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter admin name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:l.email,onChange:s=>n({...l,email:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"admin@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Password *"}),e.jsx("input",{type:"password",value:l.password,onChange:s=>n({...l,password:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter password"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{p(!1),f(null),n({name:"",email:"",password:""})},className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:M,className:"flex-1 px-4 py-2 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg font-medium hover:from-emerald-700 hover:to-teal-700 transition-all",children:"Create Admin"})]})]})]})}),C&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Edit Company"}),e.jsx("button",{onClick:()=>{m(!1),u(null),a({name:"",company_code:"",logo_url:""})},className:"text-slate-400 hover:text-slate-600",children:e.jsx(g,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Company Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>a({...t,name:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Company Code *"}),e.jsx("input",{type:"text",value:t.company_code,onChange:s=>a({...t,company_code:s.target.value.toUpperCase()}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Logo URL"}),e.jsx("input",{type:"text",value:t.logo_url,onChange:s=>a({...t,logo_url:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{m(!1),u(null),a({name:"",company_code:"",logo_url:""})},className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:S,className:"flex-1 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg font-medium hover:from-indigo-700 hover:to-purple-700 transition-all",children:"Update"})]})]})]})})]})}export{R as default};
